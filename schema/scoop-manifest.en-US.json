{
    "$comment": "Please use vscode; otherwise, markdownDescription may not work.",
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://schema.abgox.com/scoop-manifest.en-US.json",
    "title": "Schema for Scoop manifest",
    "type": "object",
    "required": [
        "version",
        "description",
        "homepage",
        "license"
    ],
    "definitions": {
        "bool": {
            "type": "boolean",
            "examples": [
                true
            ]
        },
        "str": {
            "type": "string",
            "minLength": 1,
            "allOf": [
                {
                    "not": {
                        "pattern": "^\\s[^\\s]"
                    },
                    "errorMessage": "Please remove the leading space"
                },
                {
                    "not": {
                        "pattern": "[^\\s]\\s$"
                    },
                    "errorMessage": "Please remove the trailing space"
                }
            ]
        },
        "str_or_arr": {
            "type": [
                "string",
                "array"
            ],
            "items": {
                "type": "string",
                "minLength": 1
            },
            "minLength": 1,
            "minItems": 1
        },
        "license_identifier": {
            "$comment": "Add known licenses here to provide better error messages for the validator",
            "anyOf": [
                {
                    "const": "MIT",
                    "markdownDescription": "- MIT License\n- https://spdx.org/licenses/MIT.html"
                },
                {
                    "const": "Apache-2.0",
                    "markdownDescription": "- Apache License 2.0\n- https://spdx.org/licenses/Apache-2.0.html"
                },
                {
                    "const": "BSD-3-Clause",
                    "markdownDescription": "- BSD 3-Clause \"New\" or \"Revised\" License\n- https://spdx.org/licenses/BSD-3-Clause.html"
                },
                {
                    "const": "BSD-2-Clause",
                    "markdownDescription": "- BSD 2-Clause \"Simplified\" License\n- https://spdx.org/licenses/BSD-2-Clause.html"
                },
                {
                    "const": "ISC",
                    "markdownDescription": "- ISC License\n- https://spdx.org/licenses/ISC.html"
                },
                {
                    "const": "Unlicense",
                    "markdownDescription": "- The Unlicense\n- https://spdx.org/licenses/Unlicense.html"
                },
                {
                    "const": "CC0-1.0",
                    "markdownDescription": "- Creative Commons Zero v1.0 Universal\n- https://spdx.org/licenses/CC0-1.0.html"
                },
                {
                    "const": "GPL-2.0-only",
                    "markdownDescription": "- GNU General Public License v2.0 only\n- https://spdx.org/licenses/GPL-2.0-only.html"
                },
                {
                    "const": "GPL-2.0-or-later",
                    "markdownDescription": "- GNU General Public License v2.0 or later\n- https://spdx.org/licenses/GPL-2.0-or-later.html"
                },
                {
                    "const": "GPL-3.0-only",
                    "markdownDescription": "- GNU General Public License v3.0 only\n- https://spdx.org/licenses/GPL-3.0-only.html"
                },
                {
                    "const": "GPL-3.0-or-later",
                    "markdownDescription": "- GNU General Public License v3.0 or later\n- https://spdx.org/licenses/GPL-3.0-or-later.html"
                },
                {
                    "const": "AGPL-3.0-only",
                    "markdownDescription": "- GNU Affero General Public License v3.0 only\n- https://spdx.org/licenses/AGPL-3.0-only.html"
                },
                {
                    "const": "AGPL-3.0-or-later",
                    "markdownDescription": "- GNU Affero General Public License v3.0 or later\n- https://spdx.org/licenses/AGPL-3.0-or-later.html"
                },
                {
                    "const": "LGPL-2.1-only",
                    "markdownDescription": "- GNU Library General Public License v2.1 only\n- https://spdx.org/licenses/LGPL-2.1-only.html"
                },
                {
                    "const": "LGPL-2.1-or-later",
                    "markdownDescription": "- GNU Library General Public License v2.1 or later\n- https://spdx.org/licenses/LGPL-2.1-or-later.html"
                },
                {
                    "const": "LGPL-3.0-only",
                    "markdownDescription": "- GNU Lesser General Public License v3.0 only\n- https://spdx.org/licenses/LGPL-3.0-only.html"
                },
                {
                    "const": "LGPL-3.0-or-later",
                    "markdownDescription": "- GNU Lesser General Public License v3.0 or later\n- https://spdx.org/licenses/LGPL-3.0-or-later.html"
                },
                {
                    "const": "MPL-2.0",
                    "markdownDescription": "- Mozilla Public License 2.0\n- https://spdx.org/licenses/MPL-2.0.html"
                },
                {
                    "const": "EPL-1.0",
                    "markdownDescription": "- Eclipse Public License 1.0\n- https://spdx.org/licenses/EPL-1.0.html"
                },
                {
                    "const": "EPL-2.0",
                    "markdownDescription": "- Eclipse Public License 2.0\n- https://spdx.org/licenses/EPL-2.0.html"
                },
                {
                    "const": "CDDL-1.0",
                    "markdownDescription": "- Common Development and Distribution License 1.0\n- https://spdx.org/licenses/CDDL-1.0.html"
                },
                {
                    "const": "BSL-1.0",
                    "markdownDescription": "- Boost Software License 1.0\n- https://spdx.org/licenses/BSL-1.0.html"
                },
                {
                    "const": "MS-PL",
                    "markdownDescription": "- Microsoft Public License\n- https://spdx.org/licenses/MS-PL.html"
                },
                {
                    "const": "MS-RL",
                    "markdownDescription": "- Microsoft Reciprocal License\n- https://spdx.org/licenses/MS-RL.html"
                },
                {
                    "const": "EUPL-1.2",
                    "markdownDescription": "- European Union Public License 1.2\n- https://spdx.org/licenses/EUPL-1.2.html"
                },
                {
                    "const": "CC-BY-4.0",
                    "markdownDescription": "- Creative Commons Attribution 4.0 International\n- https://spdx.org/licenses/CC-BY-4.0.html"
                },
                {
                    "const": "CC-BY-SA-4.0",
                    "markdownDescription": "- Creative Commons Attribution Share Alike 4.0 International\n- https://spdx.org/licenses/CC-BY-SA-4.0.html"
                },
                {
                    "const": "CC-BY-NC-4.0",
                    "markdownDescription": "- Creative Commons Attribution Non Commercial 4.0 International\n- https://spdx.org/licenses/CC-BY-NC-4.0.html"
                },
                {
                    "const": "OFL-1.1",
                    "markdownDescription": "- SIL Open Font License 1.1\n- https://spdx.org/licenses/OFL-1.1.html"
                },
                {
                    "const": "OFL-1.1-no-RFN",
                    "markdownDescription": "- SIL Open Font License 1.1 with no Reserved Font Name\n- https://spdx.org/licenses/OFL-1.1-no-RFN.html"
                },
                {
                    "const": "Artistic-2.0",
                    "markdownDescription": "- Artistic License 2.0\n- https://spdx.org/licenses/Artistic-2.0.html"
                },
                {
                    "const": "Zlib",
                    "markdownDescription": "- zlib License\n- https://spdx.org/licenses/Zlib.html"
                },
                {
                    "const": "Python-2.0",
                    "markdownDescription": "- Python License 2.0\n- https://spdx.org/licenses/Python-2.0.html"
                },
                {
                    "const": "NCSA",
                    "markdownDescription": "- University of Illinois/NCSA Open Source License\n- https://spdx.org/licenses/NCSA.html"
                },
                {
                    "const": "ICU",
                    "markdownDescription": "- ICU License\n- https://spdx.org/licenses/ICU.html"
                },
                {
                    "const": "IPA",
                    "markdownDescription": "- IPA Font License\n- https://spdx.org/licenses/IPA.html"
                },
                {
                    "const": "WTFPL",
                    "markdownDescription": "- Do What The F*ck You Want To Public License\n- https://spdx.org/licenses/WTFPL.html"
                },
                {
                    "const": "OSL-3.0",
                    "markdownDescription": "- Open Software License 3.0\n- https://spdx.org/licenses/OSL-3.0.html"
                }
            ]
        },
        "license_field": {
            "anyOf": [
                {
                    "const": "Unknown",
                    "markdownDescription": "- Use `Unknown`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the license cannot be determined."
                },
                {
                    "const": "Freeware",
                    "markdownDescription": "- Use `Freeware`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the software is free to use forever."
                },
                {
                    "const": "Proprietary",
                    "markdownDescription": "- Use `Proprietary`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the software is a paid software(must pay to use)"
                },
                {
                    "const": "Public Domain",
                    "markdownDescription": "- Use `Public Domain`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the software belongs to the public domain."
                },
                {
                    "const": "Shareware",
                    "markdownDescription": "- Use `Shareware`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the software is free to try, but must pay eventually."
                }
            ]
        },
        "license": {
            "title": "Software License",
            "markdownDescription": "- Specify the license or type field of the software\n- If different files have different licenses, separate the licenses with a comma `,`\n- If the entire application is dual-licensed, use `|`\n- https://spdx.org/licenses\n- https://opensource.org/license",
            "type": [
                "string",
                "object"
            ],
            "examples": [
                {}
            ],
            "anyOf": [
                {
                    "minLength": 1
                },
                {
                    "$ref": "#/definitions/license_field"
                },
                {
                    "$ref": "#/definitions/license_identifier"
                }
            ],
            "if": {
                "type": "object"
            },
            "then": {
                "required": [
                    "identifier"
                ],
                "additionalProperties": false,
                "properties": {
                    "identifier": {
                        "title": "License Identifier",
                        "markdownDescription": "- Specify the license of the software\n- If different files have different licenses, separate the licenses with a comma `,`\n- If the entire application is dual-licensed, use `|`\n- https://spdx.org/licenses\n- https://opensource.org/license",
                        "$ref": "#/definitions/str",
                        "anyOf": [
                            {
                                "minLength": 1
                            },
                            {
                                "$ref": "#/definitions/license_field"
                            },
                            {
                                "$ref": "#/definitions/license_identifier"
                            }
                        ]
                    },
                    "url": {
                        "examples": [
                            ""
                        ],
                        "allOf": [
                            {
                                "$ref": "#/definitions/str"
                            },
                            {
                                "$ref": "#/definitions/url_validation"
                            }
                        ],
                        "title": "License URL",
                        "markdownDescription": "- Specify the URL of the software license."
                    }
                }
            }
        },
        "notes": {
            "title": "Notes",
            "markdownDescription": "- The notes after installing the software.",
            "$ref": "#/definitions/str_or_arr"
        },
        "url_validation": {
            "pattern": "^https?://",
            "errorMessage": "Require a valid http/https URL"
        },
        "url": {
            "title": "Download URL",
            "markdownDescription": "- The URL of the file to be downloaded\n- If there are multiple URLs, an array can be used.\n```json\n  \"url\": [\n      \"http://example.com/file1.zip\",\n      \"http://example.com/file2.zip\"\n  ]\n  ```\n- If you need to change the file name of the download URL, you can add `#/dl.7z` at the end of the URL. For example:\n```json\n  \"url\": \"http://example.org/program.exe#/dl.7z\"\n  ```\n- Scoop will download program.exe, but save it as dl.7z, and then automatically extract it using 7-Zip.",
            "examples": [
                "https://github.com/abgox/abyss/releases/download/empty/empty"
            ],
            "type": [
                "string",
                "array"
            ],
            "$ref": "#/definitions/url_validation",
            "minLength": 1,
            "minItems": 1,
            "items": {
                "allOf": [
                    {
                        "$ref": "#/definitions/str"
                    },
                    {
                        "$ref": "#/definitions/url_validation"
                    }
                ],
                "examples": [
                    "https://github.com/abgox/abyss/releases/download/empty/empty"
                ]
            }
        },
        "hash": {
            "title": "Hash of the download file",
            "markdownDescription": "- The hash of the downloaded file.\n- The default is `SHA256`.\n- You can also use `SHA512`, `SHA1`, or `MD5` by prefixing the string with `sha512:`, `sha1:`, or `md5:`, respectively.",
            "examples": [
                "36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068"
            ],
            "type": [
                "string",
                "array"
            ],
            "minLength": 1,
            "minItems": 1,
            "items": {
                "$ref": "#/definitions/str",
                "examples": [
                    "36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068"
                ],
                "pattern": "^([a-fA-F0-9]{64}|(sha1|sha256|sha512|md5):([a-fA-F0-9]{32}|[a-fA-F0-9]{40}|[a-fA-F0-9]{64}|[a-fA-F0-9]{128}))$",
                "errorMessage": "It must be a valid hash"
            },
            "pattern": "^([a-fA-F0-9]{64}|(sha1|sha256|sha512|md5):([a-fA-F0-9]{32}|[a-fA-F0-9]{40}|[a-fA-F0-9]{64}|[a-fA-F0-9]{128}))$",
            "errorMessage": "It must be a valid hash"
        },
        "architecture_example": {
            "examples": [
                {
                    "64bit": {
                        "url": "https://github.com/abgox/abyss/releases/download/empty/empty",
                        "hash": "36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068"
                    },
                    "arm64": {
                        "url": "https://github.com/abgox/abyss/releases/download/empty/empty",
                        "hash": "36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068"
                    }
                }
            ]
        },
        "architecture_property": {
            "examples": [
                {}
            ],
            "properties": {
                "url": {
                    "examples": [
                        "",
                        []
                    ],
                    "$ref": "#/definitions/url"
                },
                "hash": {
                    "$ref": "#/definitions/hash"
                },
                "bin": {
                    "$ref": "#/definitions/bin"
                },
                "checkver": {
                    "$ref": "#/definitions/checkver"
                },
                "env_add_path": {
                    "$comment": "This property is not officially documented, but it is actually available",
                    "$ref": "#/definitions/env_add_path"
                },
                "extract_dir": {
                    "$ref": "#/definitions/extract_dir"
                },
                "installer": {
                    "$ref": "#/definitions/installer"
                },
                "pre_install": {
                    "$ref": "#/definitions/pre_install"
                },
                "post_install": {
                    "$ref": "#/definitions/post_install"
                },
                "shortcuts": {
                    "$ref": "#/definitions/shortcuts"
                },
                "uninstaller": {
                    "$ref": "#/definitions/uninstaller"
                }
            },
            "minProperties": 1,
            "additionalProperties": false
        },
        "architecture": {
            "title": "Architecture information",
            "markdownDescription": "- The architecture information of the program.\n- Architecture can be used to wrap differences",
            "type": "object",
            "minProperties": 1,
            "additionalProperties": false,
            "properties": {
                "64bit": {
                    "markdownDescription": "- 64bit architecture",
                    "$ref": "#/definitions/architecture_property"
                },
                "32bit": {
                    "markdownDescription": "- 32bit architecture",
                    "$ref": "#/definitions/architecture_property"
                },
                "arm64": {
                    "markdownDescription": "- arm64 architecture",
                    "$ref": "#/definitions/architecture_property"
                }
            }
        },
        "extract_dir": {
            "title": "Extract specified directory only",
            "markdownDescription": "- If the value of the url property points to a compressed package, Scoop will extract all content by default.\n  - Compressed package types: `.zip`/`.7z`/`.tar`/`.gz`/`.lzma`/`.lzh`\n- If the `extract_dir` property is defined, Scoop will only extract the specified directory defined in `extract_dir`.",
            "$ref": "#/definitions/str_or_arr"
        },
        "extract_to": {
            "title": "Extract content to specified directory",
            "markdownDescription": "- If the value of the url property points to a compressed package, Scoop will extract all content to the directory defined by `extract_to`\n  - Compressed package types: `.zip`/`.7z`/`.tar`/`.gz`/`.lzma`/`.lzh`\n- If url is an array with multiple compressed packages, `extract_to` should also be an array with the same order as url",
            "$ref": "#/definitions/str_or_arr"
        },
        "env_add_path": {
            "title": "Add the specified directory to the PATH environment variable",
            "markdownDescription": "- Add the specified directory to the PATH environment variable (current user)\n- If you want to specify the `$dir` directory, please use `.` instead.\n- If the `--global` or `-g` parameter is used during installation, the directory will be added to the PATH environment variable (system level)",
            "type": [
                "string",
                "array"
            ],
            "examples": [
                "",
                []
            ],
            "minLength": 1,
            "minItems": 1,
            "uniqueItems": true
        },
        "env_set": {
            "title": "Set environment variables",
            "markdownDescription": "- Set one or more environment variables (current user)\n- If the `--global` or `-g` parameter is used during installation, the variables will be set in the system environment variables (system level)\n- Available variables:\n  - `$dir`\n  - `$persist_dir`\n  - `$home`\n  - `$env:AppData`\n  - ...",
            "type": "object",
            "examples": [
                {}
            ],
            "if": {
                "type": "object"
            },
            "then": {
                "patternProperties": {
                    "^.+$": {
                        "$ref": "#/definitions/str",
                        "examples": [
                            "$dir\\xxx",
                            "$persist_dir\\xxx"
                        ]
                    }
                },
                "minProperties": 1,
                "additionalProperties": false,
                "errorMessage": "Property names cannot be empty strings"
            }
        },
        "psmodule": {
            "title": "PowerShell module",
            "markdownDescription": "- Install as PowerShell module in `$scoopdir/modules`",
            "type": "object",
            "required": [
                "name"
            ],
            "examples": [
                {
                    "name": ""
                }
            ],
            "properties": {
                "name": {
                    "title": "Module name",
                    "markdownDescription": "- The name of the module, which should match at least one file in the extract directory for PowerShell to recognize it as a module",
                    "$ref": "#/definitions/str"
                }
            },
            "additionalProperties": false
        },
        "bin": {
            "type": [
                "string",
                "array"
            ],
            "items": {
                "type": [
                    "string",
                    "array"
                ],
                "minLength": 1,
                "anyOf": [
                    {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/str"
                        },
                        "allOf": [
                            {
                                "items": [
                                    {
                                        "markdownDescription": "Required: program name"
                                    },
                                    {
                                        "markdownDescription": "Required: alias (shim)"
                                    },
                                    {
                                        "markdownDescription": "Optional: parameters"
                                    }
                                ]
                            },
                            {
                                "if": {
                                    "minItems": 1,
                                    "maxItems": 1
                                },
                                "then": {
                                    "not": true,
                                    "errorMessage": "Missing second required value: alias (shim)"
                                }
                            },
                            {
                                "if": {
                                    "maxItems": 0
                                },
                                "then": {
                                    "not": true,
                                    "errorMessage": "Missing two required values: program name, alias (shim)"
                                }
                            }
                        ],
                        "minItems": 1,
                        "maxItems": 3
                    },
                    {
                        "$ref": "#/definitions/str"
                    }
                ]
            },
            "minLength": 1,
            "minItems": 1,
            "uniqueItems": true,
            "title": "Program (executable or script) string or string array",
            "markdownDescription": "- A string or array of strings representing programs (executables or scripts) to be made available on the user's PATH\n- A two-dimensional array can be used to create an alias shim that uses a different name from the real executable and optionally passes arguments to it\n- The inner array must contain at most three strings: program name, alias, arguments (optional)\n- Example 1: Scoop will create a shim named `a`, so you can run a.exe by typing `a`\n```json\n  \"bin\": \"a.exe\"\n  ```\n- Example 2: Same as Example 1, but Scoop creates two shims: `a` and `b`\n```json\n  \"bin\": [\"a.exe\", \"b.exe\"]\n  ```\n- Example 3: Same as Example 2, but the shims are named `ax` and `bx`\n```json\n  \"bin\": [\n    [\"a.exe\", \"ax\"], \n    [\"b.exe\", \"bx\"]\n  ]\n  ```\n- Example 4: Same as Example 3, but running the shims will automatically pass `--config $dir/config.json`\n```json\n  \"bin\": [\n    [\"a.exe\", \"ax\", \"--config $dir/config.json\"], \n    [\"b.exe\", \"bx\", \"--config $dir/config.json\"]\n  ]\n  ```"
        },
        "shortcuts": {
            "type": "array",
            "title": "Some shortcuts added to the Start menu",
            "markdownDescription": "- Specifies shortcuts to be added to the Start menu, placed in the `Scoop Apps` folder\n- Each array can contain up to four values:\n    1. Required: path to the target file\n    2. Required: name of the shortcut; subdirectories are supported: `aaa\\bbb`\n    3. Optional: launch arguments\n    4. Optional: path to the icon file",
            "items": {
                "type": "array",
                "items": {
                    "$ref": "#/definitions/str"
                },
                "allOf": [
                    {
                        "items": [
                            {
                                "markdownDescription": "Required: path to the target file"
                            },
                            {
                                "markdownDescription": "Required: name of the shortcut; subdirectories are supported: `aaa\\bbb`"
                            },
                            {
                                "markdownDescription": "Optional: launch arguments"
                            },
                            {
                                "markdownDescription": "Optional: path to the icon file"
                            }
                        ]
                    },
                    {
                        "if": {
                            "minItems": 1,
                            "maxItems": 1
                        },
                        "then": {
                            "not": true,
                            "errorMessage": "Missing second required value: shortcut name"
                        }
                    },
                    {
                        "if": {
                            "maxItems": 0
                        },
                        "then": {
                            "not": true,
                            "errorMessage": "Missing two required values: target file path, shortcut name"
                        }
                    }
                ],
                "minItems": 1,
                "maxItems": 4
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "persist": {
            "title": "Persisted data",
            "markdownDescription": "- Scoop will persist the specified directories and files.\n- Note: Scoop creates directory junctions by default; if you need file-level linking, create the file first in your install script.\n- Example 1: Directory junction: `$dir\\data` => `$persist_dir\\data`\n```json\n  \"persist\": \"data\"\n  ```\n- Example 2: Same as Ex.1 but multiple items\n```json\n  \"persist\": [\"data\", \"config.json\"]\n  ```\n- Example 3: Same as Ex.2 but with custom target names\n```json\n  \"persist\": [\n    [\"app\\\\data\", \"userData\"], \n    [\"app\\\\config.json\", \"config.json\"]\n  ]\n  ```",
            "type": [
                "string",
                "array"
            ],
            "items": {
                "type": [
                    "string",
                    "array"
                ],
                "minLength": 1,
                "anyOf": [
                    {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/str"
                        },
                        "allOf": [
                            {
                                "items": [
                                    {
                                        "markdownDescription": "Original file or directory to persist"
                                    },
                                    {
                                        "markdownDescription": "Target location for the persisted data, supports subdirectories: `aaa\\bbb`"
                                    }
                                ]
                            },
                            {
                                "if": {
                                    "minItems": 1,
                                    "maxItems": 1
                                },
                                "then": {
                                    "not": true,
                                    "errorMessage": "Missing second required value: target location for the persisted data"
                                }
                            },
                            {
                                "if": {
                                    "maxItems": 0
                                },
                                "then": {
                                    "not": true,
                                    "errorMessage": "Missing two required values: original file or directory to persist, target location for the persisted data"
                                }
                            }
                        ],
                        "minItems": 1,
                        "maxItems": 3
                    },
                    {
                        "$ref": "#/definitions/str"
                    }
                ]
            },
            "minLength": 1,
            "minItems": 1,
            "uniqueItems": true,
            "examples": [
                "",
                [],
                [
                    []
                ]
            ]
        },
        "pre_install": {
            "title": "Pre-install script",
            "markdownDescription": "- Commands to be executed before installing the application\n- Execution order: `pre_install` -> `installer` -> `post_install`\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (actual version number directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
            "$ref": "#/definitions/str_or_arr"
        },
        "installer": {
            "title": "Installer configuration",
            "markdownDescription": "- Configuration for running non-MSI installers\n- Called during scoop install and scoop update\n- Execution order: `pre_install` -> `installer` -> `post_install`",
            "type": "object",
            "minProperties": 1,
            "additionalProperties": false,
            "examples": [
                {}
            ],
            "properties": {
                "file": {
                    "markdownDescription": "Executable file for the installer\n- Defaults to the last downloaded URL if not specified\n- Required if specified in uninstaller",
                    "$ref": "#/definitions/str"
                },
                "script": {
                    "markdownDescription": "Execute as an installer instead of a file\n- Available variables in the script:\n    - $fname: downloaded file(s) (may be an array; treat as array unless you are sure url is not an array)\n    - $manifest: validated manifest reference\n    - $architecture: 64bit/32bit/arm64\n    - $dir: installation directory",
                    "$ref": "#/definitions/str_or_arr"
                },
                "args": {
                    "type": "array",
                    "markdownDescription": "Array of arguments to pass to the installer\n- Optional property",
                    "items": {
                        "$ref": "#/definitions/str"
                    },
                    "minItems": 1
                },
                "keep": {
                    "markdownDescription": "Set to true if the installer should be kept after running (e.g., for future uninstallation)\n- If omitted or set to any other value, the installer will be deleted after running",
                    "$ref": "#/definitions/bool"
                }
            }
        },
        "post_install": {
            "title": "Post-install script",
            "markdownDescription": "- Commands executed after the application is installed\n- Execution order: `pre_install` -> `installer` -> `post_install`\n- Note: At this point, Scoop has already completed persist, so if you need to create files for persist, do it before this (in `pre_install`)\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (current directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
            "$ref": "#/definitions/str_or_arr"
        },
        "pre_uninstall": {
            "title": "Pre-uninstall script",
            "markdownDescription": "- Execute commands before uninstalling the application\n- Execution order: `pre_uninstall` -> `uninstaller` -> `post_uninstall`\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (actual version number directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
            "$ref": "#/definitions/str_or_arr"
        },
        "uninstaller": {
            "title": "Uninstaller configuration",
            "markdownDescription": "- Configuration for running non-MSI uninstallers\n- Called during scoop uninstall and scoop update\n- Execution order: `pre_uninstall` -> `uninstaller` -> `post_uninstall`",
            "type": "object",
            "minProperties": 1,
            "additionalProperties": false,
            "examples": [
                {}
            ],
            "properties": {
                "file": {
                    "markdownDescription": "Uninstall the program executable file",
                    "$ref": "#/definitions/str"
                },
                "script": {
                    "markdownDescription": "Execute as an uninstaller rather than a file\n- Variables available in the script: \n    - $fname: downloaded file (there may be multiple files, which need to be handled as an array unless you are sure the url is not an array)\n    - $manifest: verified manifest reference\n    - $architecture: 64bit/32bit/arm64\n    - $dir: installation directory",
                    "$ref": "#/definitions/str_or_arr"
                },
                "args": {
                    "type": "array",
                    "markdownDescription": "Array of arguments to pass to the uninstaller\n- Optional property",
                    "items": {
                        "$ref": "#/definitions/str"
                    },
                    "minItems": 1
                }
            }
        },
        "post_uninstall": {
            "title": "Post-uninstall script",
            "markdownDescription": "- Used to execute commands after uninstalling the application\n- Execution order: `pre_uninstall` -> `uninstaller` -> `post_uninstall`\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (current directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
            "$ref": "#/definitions/str_or_arr"
        },
        "checkver": {
            "title": "Version check configuration",
            "markdownDescription": "- Application maintainers and developers can use the bin/checkver tool to check for updates to the application\n- String: RegEx to find the version on the homepage\n- Object: More rich configuration",
            "type": [
                "string",
                "object"
            ],
            "examples": [
                "",
                "github",
                {}
            ],
            "minLength": 1,
            "oneOf": [
                {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                        "url": {
                            "markdownDescription": "URL of the page where the version is located",
                            "$ref": "#/definitions/str"
                        },
                        "github": {
                            "markdownDescription": "GitHub repository of the application",
                            "$ref": "#/definitions/str",
                            "if": {
                                "type": "string"
                            },
                            "then": {
                                "minLength": 1,
                                "pattern": "^https?://github\\.com/[^/]+/[^/]+/?$",
                                "not": {
                                    "pattern": "\\.git(\\/|$)"
                                },
                                "errorMessage": "GitHub repository format error, such as: https://github.com/abgox/abyss"
                            }
                        },
                        "re": {
                            "markdownDescription": "re is an alias for regex\n- RegEx to find the version on the homepage",
                            "$ref": "#/definitions/str"
                        },
                        "regex": {
                            "markdownDescription": "RegEx to find the version on the homepage",
                            "$ref": "#/definitions/str",
                            "examples": [
                                "(.+)"
                            ]
                        },
                        "jsonpath": {
                            "markdownDescription": "Use a JSON endpoint with a JSONPath expression to retrieve the version, you can use dot notation or bracket notation.\n- Usage:\n    - `\"$.version\"`: Extract the value of `version`\n    - `\"$..[?(@.productVersion || @.version)]\"`: Extract the value of `productVersion` or `version`\n    - `\"$.assets[?(@.name == 'xxx')].updated_at\"`: Extract `updated_at` from the field in `assets` where `name` is `xxx`\n    - `\"$..['productVersion','version']\"`:\n      - Extract the values of these two fields and form an array.\n      - Like: `\"[\"1.2.3\",\"1.2.3-rc\"]\"`",
                            "$ref": "#/definitions/str"
                        },
                        "jp": {
                            "markdownDescription": "jp is an alias for jsonpath\n- Use a JSON endpoint with a JSONPath expression to retrieve the version, you can use dot notation or bracket notation.\n- Usage:\n    - `\"$.version\"`: Extract the value of `version`\n    - `\"$..[?(@.productVersion || @.version)]\"`: Extract the value of `productVersion` or `version`\n    - `\"$.assets[?(@.name == 'xxx')].updated_at\"`: Extract `updated_at` from the field in `assets` where `name` is `xxx`\n    - `\"$..['productVersion','version']\"`:\n      - Extract the values of these two fields and form an array.\n      - Like: `\"[\"1.2.3\",\"1.2.3-rc\"]\"`",
                            "$ref": "#/definitions/str"
                        },
                        "xpath": {
                            "markdownDescription": "XPath expression to find the version on the homepage",
                            "$ref": "#/definitions/str"
                        },
                        "reverse": {
                            "markdownDescription": "If set to true, it matches the last occurrence (default is the first occurrence)",
                            "$ref": "#/definitions/bool"
                        },
                        "replace": {
                            "markdownDescription": "Replace the matched value with the computed value",
                            "$ref": "#/definitions/str",
                            "anyOf": [
                                {},
                                {
                                    "const": "${1}.${2}.${3}.${4}${5}${6}",
                                    "markdownDescription": "Replace the matched value with `${1}.${2}.${3}.${4}${5}${6}`, where `${1}` represents the first match group, `${2}` represents the second match group, and so on."
                                }
                            ]
                        },
                        "useragent": {
                            "markdownDescription": "User-Agent used to fetch the webpage content",
                            "$ref": "#/definitions/str"
                        },
                        "script": {
                            "markdownDescription": "PowerShell script to track multiple links",
                            "$ref": "#/definitions/str_or_arr"
                        },
                        "sourceforge": {
                            "markdownDescription": "SourceForge project version check configuration",
                            "$ref": "#/definitions/str"
                        }
                    },
                    "minProperties": 1
                },
                {
                    "$ref": "#/definitions/str",
                    "anyOf": [
                        {},
                        {
                            "const": "github",
                            "markdownDescription": "If the homepage is a GitHub repository homepage, you can use the \"github\" string as the checkver configuration"
                        }
                    ]
                }
            ]
        },
        "autoupdate_url": {
            "title": "Software download URL",
            "markdownDescription": "- It is usually dynamic and includes [version variables](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifest-Autoupdate#version-variables), refer to the hover tip of the `autoupdate` field\n- For example: `https://github.com/owner/repo/releases/download/v$version/xxx.exe`\n- If there are multiple URLs, an array can be used.\n```json\n  \"url\": [\n      \"http://example.com/file1.zip\",\n      \"http://example.com/file2.zip\"\n  ]\n  ```\n- If you need to change the file name of the download URL, you can add `#/dl.7z` at the end of the URL. For example:\n```json\n  \"url\": \"http://example.org/program.exe#/dl.7z\"\n  ```\n- Scoop will download program.exe, but save it as dl.7z, and then automatically extract it using 7-Zip.",
            "type": [
                "string",
                "array"
            ],
            "examples": [
                "",
                []
            ],
            "minLength": 1,
            "minItems": 1,
            "items": {
                "$ref": "#/definitions/str"
            }
        },
        "autoupdate_hash": {
            "markdownDescription": "- Define how to get the hash for the software download",
            "type": "object",
            "additionalProperties": false,
            "minProperties": 1,
            "properties": {
                "url": {
                    "markdownDescription": "URL template to download the RDF/JSON file or extract the hash",
                    "$ref": "#/definitions/str"
                },
                "regex": {
                    "markdownDescription": "RegEx expression to extract the hash (Alias: find)",
                    "$ref": "#/definitions/str"
                },
                "find": {
                    "markdownDescription": "RegEx expression to extract the hash (Alias: regex)",
                    "$ref": "#/definitions/str"
                },
                "mode": {
                    "title": "Hash retrieval mode",
                    "oneOf": [
                        {
                            "const": "github",
                            "markdownDescription": "- Get the hash generated by GitHub automatically, for more details, please refer to [GitHub blog](https://github.blog/changelog/2025-06-03-releases-now-expose-digests-for-release-assets/)"
                        },
                        {
                            "const": "extract",
                            "markdownDescription": "- Extract the hash from a plain text file or web page using RegEx (default, can be omitted)"
                        },
                        {
                            "const": "json",
                            "markdownDescription": "- Extract the hash from a JSON file using JSONPath"
                        },
                        {
                            "const": "xpath",
                            "markdownDescription": "- Extract the hash from an XML file using XPath"
                        },
                        {
                            "const": "rdf",
                            "markdownDescription": "- Extract the hash from an RDF file"
                        },
                        {
                            "const": "metalink",
                            "markdownDescription": "- Extract the hash from a Metalink header file or .meta4 file"
                        },
                        {
                            "const": "fosshub",
                            "markdownDescription": "- Predefined for FossHub"
                        },
                        {
                            "const": "sourceforge",
                            "markdownDescription": "- Predefined for SourceForge"
                        },
                        {
                            "const": "download",
                            "markdownDescription": "- Download the application file and hash it locally (fallback)"
                        }
                    ]
                },
                "jp": {
                    "markdownDescription": "JSONPath expression to extract the hash (Alias: jsonpath)\n- Usage:\n    - `\"$.version\"`: Extract the value of `version`\n    - `\"$..[?(@.productVersion || @.version)]\"`: Extract the value of `productVersion` or `version`\n    - `\"$.assets[?(@.name == 'xxx')].updated_at\"`: Extract `updated_at` from the field in `assets` where `name` is `xxx`\n    - `\"$..['productVersion','version']\"`:\n      - Extract the values of these two fields and form an array.\n      - Like: `\"[\"1.2.3\",\"1.2.3-rc\"]\"`",
                    "$ref": "#/definitions/str"
                },
                "jsonpath": {
                    "markdownDescription": "JSONPath expression to extract the hash (Alias: jp)\n- Usage:\n    - `\"$.version\"`: Extract the value of `version`\n    - `\"$..[?(@.productVersion || @.version)]\"`: Extract the value of `productVersion` or `version`\n    - `\"$.assets[?(@.name == 'xxx')].updated_at\"`: Extract `updated_at` from the field in `assets` where `name` is `xxx`\n    - `\"$..['productVersion','version']\"`:\n      - Extract the values of these two fields and form an array.\n      - Like: `\"[\"1.2.3\",\"1.2.3-rc\"]\"`",
                    "$ref": "#/definitions/str"
                },
                "xpath": {
                    "markdownDescription": "XPath expression to extract the hash value",
                    "$ref": "#/definitions/str"
                }
            }
        },
        "autoupdate_architecture": {
            "required": [
                "url"
            ],
            "properties": {
                "url": {
                    "$ref": "#/definitions/autoupdate_url"
                },
                "hash": {
                    "$ref": "#/definitions/autoupdate_hash"
                },
                "bin": {
                    "$ref": "#/definitions/bin"
                },
                "checkver": {
                    "$ref": "#/definitions/checkver"
                },
                "env_add_path": {
                    "$comment": "This property is not officially documented, but it is actually available",
                    "$ref": "#/definitions/env_add_path"
                },
                "extract_dir": {
                    "$ref": "#/definitions/extract_dir"
                },
                "installer": {
                    "$ref": "#/definitions/installer"
                },
                "pre_install": {
                    "$ref": "#/definitions/pre_install"
                },
                "post_install": {
                    "$ref": "#/definitions/post_install"
                },
                "shortcuts": {
                    "$ref": "#/definitions/shortcuts"
                },
                "uninstaller": {
                    "$ref": "#/definitions/uninstaller"
                }
            },
            "minProperties": 1,
            "additionalProperties": false
        },
        "github_release_url": {
            "required": [
                "url"
            ],
            "properties": {
                "url": {
                    "type": [
                        "array",
                        "string"
                    ],
                    "examples": [
                        "",
                        []
                    ],
                    "pattern": "^https://github\\.com/[^/]+/[^/]+/releases/download/",
                    "items": {
                        "type": "string",
                        "pattern": "^https://github\\.com/[^/]+/[^/]+/releases/download/"
                    }
                }
            }
        },
        "url_hash_type_match": {
            "required": [
                "url",
                "hash"
            ],
            "if": {
                "properties": {
                    "url": {
                        "type": "string"
                    }
                }
            },
            "then": {
                "properties": {
                    "hash": {
                        "$ref": "#/definitions/str",
                        "errorMessage": "The type of 'url' and 'hash' must be same"
                    }
                }
            },
            "else": {
                "properties": {
                    "hash": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/hash"
                        },
                        "minItems": 1,
                        "errorMessage": "The type of 'url' and 'hash' must be same"
                    }
                }
            }
        }
    },
    "properties": {
        "##": {
            "title": "Comment",
            "markdownDescription": "- Comment for readers or maintainers of this manifest.",
            "$ref": "#/definitions/str_or_arr"
        },
        "version": {
            "title": "Version",
            "markdownDescription": "- Version number of the software.",
            "$ref": "#/definitions/str",
            "examples": [
                "0.0.0"
            ],
            "anyOf": [
                {},
                {
                    "const": "0.0.0",
                    "markdownDescription": "- Current version is 0.0.0"
                },
                {
                    "const": "nightly",
                    "markdownDescription": "- Current version is nightly"
                }
            ]
        },
        "description": {
            "title": "App Description",
            "markdownDescription": "- A brief description of the software.",
            "$ref": "#/definitions/str"
        },
        "homepage": {
            "title": "Homepage",
            "markdownDescription": "- Homepage or repository URL of the app",
            "examples": [
                ""
            ],
            "allOf": [
                {
                    "$ref": "#/definitions/str"
                },
                {
                    "$ref": "#/definitions/url_validation"
                }
            ],
            "if": {
                "pattern": "^https?://[^/]+$"
            },
            "then": {
                "not": true,
                "errorMessage": "If it is the root domain of the official website, please end with '/'"
            }
        },
        "license": {
            "$ref": "#/definitions/license"
        },
        "depends": {
            "title": "Dependencies",
            "markdownDescription": "- Dependencies of the app\n- Missing dependencies will be automatically installed before the app is installed\n- If a dependency is optional, please use the `suggest` property",
            "$ref": "#/definitions/str_or_arr"
        },
        "suggest": {
            "title": "Suggested Dependencies",
            "markdownDescription": "- Suggested dependencies of the app\n- If any of the suggested dependencies are already installed, the feature will be considered as **implemented**, and the user will not see any suggestions",
            "type": "object",
            "if": {
                "type": "object"
            },
            "then": {
                "patternProperties": {
                    "^.+$": {
                        "markdownDescription": "- If any of the suggested dependencies are already installed, the feature will be considered as **implemented**, and the user will not see any suggestions\n- If it is an array, it means that if any of the dependencies in the array are installed, the feature will be considered as **implemented**",
                        "$ref": "#/definitions/str_or_arr"
                    }
                },
                "minProperties": 1,
                "additionalProperties": false,
                "errorMessage": "Property names are not allowed to be empty strings."
            }
        },
        "notes": {
            "$ref": "#/definitions/notes"
        },
        "url": {
            "$ref": "#/definitions/url"
        },
        "hash": {
            "$ref": "#/definitions/hash"
        },
        "architecture": {
            "$ref": "#/definitions/architecture"
        },
        "extract_dir": {
            "$ref": "#/definitions/extract_dir"
        },
        "extract_to": {
            "$ref": "#/definitions/extract_to"
        },
        "env_add_path": {
            "$ref": "#/definitions/env_add_path"
        },
        "env_set": {
            "$ref": "#/definitions/env_set"
        },
        "innosetup": {
            "markdownDescription": "If the installer is based on `InnoSetup`, set it to `true`",
            "$ref": "#/definitions/bool"
        },
        "psmodule": {
            "$ref": "#/definitions/psmodule"
        },
        "bin": {
            "$ref": "#/definitions/bin"
        },
        "shortcuts": {
            "$ref": "#/definitions/shortcuts"
        },
        "persist": {
            "$ref": "#/definitions/persist"
        },
        "pre_install": {
            "$ref": "#/definitions/pre_install"
        },
        "installer": {
            "$ref": "#/definitions/installer"
        },
        "post_install": {
            "$ref": "#/definitions/post_install"
        },
        "pre_uninstall": {
            "$ref": "#/definitions/pre_uninstall"
        },
        "uninstaller": {
            "$ref": "#/definitions/uninstaller"
        },
        "post_uninstall": {
            "$ref": "#/definitions/post_uninstall"
        },
        "checkver": {
            "$ref": "#/definitions/checkver"
        },
        "autoupdate": {
            "title": "Auto Update",
            "markdownDescription": "- It will automatically update the manifest via [Github Actions](https://github.com/ScoopInstaller/GithubActions)\n - Scoop can install specific versions using `scoop install AppName@1.2.3`\n - The prerequisite is that `url` in the `autoupdate` of the manifest can only contain the following [version variables](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifest-Autoupdate#version-variables)\n  - `$version`: `3.7.1.2-rc.1`\n    - `$majorVersion`: `3`\n    - `$minorVersion`: `7`\n    - `$patchVersion`: `1`\n    - `$buildVersion`: `2`\n    - `$preReleaseVersion`: `rc.1`\n  - `$dotVersion`: `3.7.1.2.rc.1`\n  - `$dashVersion`: `3-7-1-2-rc-1`\n  - `$underscoreVersion`: `3_7_1_2_rc_1`\n  - `$cleanVersion`: `3712rc1`\n  - `$matchHead`: `3.7.1`\n  - `$matchTail`: `.2-rc.1`",
            "type": "object",
            "minProperties": 1,
            "examples": [
                {
                    "url": ""
                },
                {
                    "architecture": {
                        "64bit": {
                            "url": ""
                        }
                    }
                }
            ],
            "properties": {
                "architecture": {
                    "type": "object",
                    "title": "Auto Update Architecture",
                    "markdownDescription": "- Define the architecture for auto update\n- Architecture can be used to wrap differences",
                    "properties": {
                        "64bit": {
                            "markdownDescription": "64bit architecture",
                            "$ref": "#/definitions/autoupdate_architecture"
                        },
                        "32bit": {
                            "markdownDescription": "32bit architecture",
                            "$ref": "#/definitions/autoupdate_architecture"
                        },
                        "arm64": {
                            "markdownDescription": "arm64 architecture",
                            "$ref": "#/definitions/autoupdate_architecture"
                        }
                    },
                    "additionalProperties": false,
                    "minProperties": 1
                },
                "notes": {
                    "$ref": "#/definitions/notes"
                },
                "url": {
                    "$ref": "#/definitions/autoupdate_url"
                },
                "hash": {
                    "$ref": "#/definitions/autoupdate_hash"
                },
                "bin": {
                    "$ref": "#/definitions/bin"
                },
                "extract_dir": {
                    "$ref": "#/definitions/extract_dir"
                },
                "extract_to": {
                    "$ref": "#/definitions/extract_to"
                },
                "env_add_path": {
                    "$ref": "#/definitions/env_add_path"
                },
                "env_set": {
                    "$ref": "#/definitions/env_set"
                },
                "installer": {
                    "$ref": "#/definitions/installer"
                },
                "license": {
                    "$ref": "#/definitions/license"
                },
                "persist": {
                    "$ref": "#/definitions/persist"
                },
                "post_install": {
                    "$ref": "#/definitions/post_install"
                },
                "psmodule": {
                    "$ref": "#/definitions/psmodule"
                },
                "shortcuts": {
                    "$ref": "#/definitions/shortcuts"
                }
            }
        }
    },
    "allOf": [
        {
            "required": [
                "version",
                "description",
                "homepage",
                "license"
            ]
        },
        {
            "$comment": "Standard Specifications of Scoop",
            "allOf": [
                {
                    "$comment": "If 'checkver' is set, 'autoupdate' must be set.",
                    "allOf": [
                        {
                            "if": {
                                "required": [
                                    "checkver"
                                ]
                            },
                            "then": {
                                "if": {
                                    "required": [
                                        "autoupdate"
                                    ]
                                },
                                "else": {
                                    "properties": {
                                        "checkver": {
                                            "not": true,
                                            "errorMessage": "If 'checkver' is set, 'autoupdate' must be set."
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "if": {
                                "required": [
                                    "autoupdate"
                                ]
                            },
                            "then": {
                                "if": {
                                    "required": [
                                        "checkver"
                                    ]
                                },
                                "else": {
                                    "properties": {
                                        "autoupdate": {
                                            "not": true,
                                            "errorMessage": "If 'autoupdate' is set, 'checkver' must be set."
                                        }
                                    }
                                }
                            }
                        }
                    ]
                },
                {
                    "$comment": "If 'url' is a GitHub releases link, 'mode.hash' must be set to 'github'.",
                    "properties": {
                        "autoupdate": {
                            "type": "object",
                            "if": {
                                "oneOf": [
                                    {
                                        "$ref": "#/definitions/github_release_url"
                                    },
                                    {
                                        "required": [
                                            "architecture"
                                        ],
                                        "properties": {
                                            "architecture": {
                                                "type": "object",
                                                "anyOf": [
                                                    {
                                                        "required": [
                                                            "64bit"
                                                        ]
                                                    },
                                                    {
                                                        "required": [
                                                            "arm64"
                                                        ]
                                                    },
                                                    {
                                                        "required": [
                                                            "32bit"
                                                        ]
                                                    }
                                                ],
                                                "patternProperties": {
                                                    "^(64bit|arm64|32bit)$": {
                                                        "$ref": "#/definitions/github_release_url"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            },
                            "then": {
                                "required": [
                                    "hash"
                                ],
                                "properties": {
                                    "hash": {
                                        "required": [
                                            "mode"
                                        ],
                                        "properties": {
                                            "mode": {
                                                "const": "github"
                                            }
                                        }
                                    }
                                }
                            },
                            "else": {
                                "properties": {
                                    "hash": {
                                        "properties": {
                                            "mode": {
                                                "not": {
                                                    "const": "github"
                                                },
                                                "errorMessage": "'url' is not a standard Github Releases."
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "$comment": "If 'license' is set but 'url' or 'architecture' is not set, a warning is triggered.",
                    "if": {
                        "not": {
                            "anyOf": [
                                {
                                    "required": [
                                        "url"
                                    ]
                                },
                                {
                                    "required": [
                                        "architecture"
                                    ]
                                }
                            ]
                        }
                    },
                    "then": {
                        "not": {
                            "anyOf": [
                                {
                                    "not": {
                                        "required": [
                                            "url"
                                        ]
                                    }
                                },
                                {
                                    "not": {
                                        "required": [
                                            "architecture"
                                        ]
                                    }
                                }
                            ]
                        },
                        "errorMessage": "Missing property 'url' or 'architecture'"
                    }
                },
                {
                    "$comment": "Only one of 'url' and 'architecture' can be chosen. The type of 'url' and 'hash' must match.",
                    "if": {
                        "required": [
                            "url"
                        ]
                    },
                    "then": {
                        "properties": {
                            "architecture": {
                                "patternProperties": {
                                    "^(64bit|arm64|32bit)$": {
                                        "properties": {
                                            "url": {
                                                "not": true,
                                                "errorMessage": "Property 'url' in 'architecture' conflicts with the top-level 'url'. You can only choose one way."
                                            },
                                            "hash": {
                                                "not": true,
                                                "errorMessage": "If the top-level 'url' is set, 'hash' in 'architecture' cannot be set."
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "$ref": "#/definitions/url_hash_type_match"
                    },
                    "else": {
                        "properties": {
                            "architecture": {
                                "$ref": "#/definitions/architecture_example",
                                "patternProperties": {
                                    "^(64bit|arm64|32bit)$": {
                                        "$ref": "#/definitions/url_hash_type_match"
                                    }
                                }
                            },
                            "hash": {
                                "not": true,
                                "errorMessage": "If 'url' is not set, 'hash' cannot be set."
                            }
                        }
                    }
                },
                {
                    "$comment": "Ensure that the 'architecture' and 'autoupdate.architecture' are consistent.",
                    "if": {
                        "required": [
                            "autoupdate"
                        ],
                        "properties": {
                            "autoupdate": {
                                "required": [
                                    "architecture"
                                ]
                            }
                        }
                    },
                    "then": {
                        "allOf": [
                            {
                                "if": {
                                    "properties": {
                                        "autoupdate": {
                                            "properties": {
                                                "architecture": {
                                                    "required": [
                                                        "64bit"
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                },
                                "then": {
                                    "properties": {
                                        "architecture": {
                                            "required": [
                                                "64bit"
                                            ]
                                        }
                                    }
                                },
                                "else": {
                                    "properties": {
                                        "architecture": {
                                            "properties": {
                                                "64bit": {
                                                    "not": true,
                                                    "errorMessage": "The 'architecture' in 'autoupdate' does not set '64bit'."
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "if": {
                                    "properties": {
                                        "autoupdate": {
                                            "properties": {
                                                "architecture": {
                                                    "required": [
                                                        "32bit"
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                },
                                "then": {
                                    "properties": {
                                        "architecture": {
                                            "required": [
                                                "32bit"
                                            ]
                                        }
                                    }
                                },
                                "else": {
                                    "properties": {
                                        "architecture": {
                                            "properties": {
                                                "32bit": {
                                                    "not": true,
                                                    "errorMessage": "The 'architecture' in 'autoupdate' does not set '32bit'."
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "if": {
                                    "properties": {
                                        "autoupdate": {
                                            "properties": {
                                                "architecture": {
                                                    "required": [
                                                        "arm64"
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                },
                                "then": {
                                    "properties": {
                                        "architecture": {
                                            "required": [
                                                "arm64"
                                            ]
                                        }
                                    }
                                },
                                "else": {
                                    "properties": {
                                        "architecture": {
                                            "properties": {
                                                "arm64": {
                                                    "not": true,
                                                    "errorMessage": "The 'architecture' in 'autoupdate' does not set 'arm64'."
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "allOf": [
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "required": [
                                                        "extract_dir"
                                                    ]
                                                }
                                            }
                                        },
                                        "then": {
                                            "required": [
                                                "extract_dir"
                                            ]
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "required": [
                                                        "env_add_path"
                                                    ]
                                                }
                                            }
                                        },
                                        "then": {
                                            "required": [
                                                "env_add_path"
                                            ]
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "required": [
                                                        "bin"
                                                    ]
                                                }
                                            }
                                        },
                                        "then": {
                                            "required": [
                                                "bin"
                                            ]
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "required": [
                                                        "shortcuts"
                                                    ]
                                                }
                                            }
                                        },
                                        "then": {
                                            "required": [
                                                "shortcuts"
                                            ]
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "properties": {
                                                        "architecture": {
                                                            "patternProperties": {
                                                                "^(64bit|arm64|32bit)$": {
                                                                    "required": [
                                                                        "extract_dir"
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "architecture": {
                                                    "patternProperties": {
                                                        "^(64bit|arm64|32bit)$": {
                                                            "required": [
                                                                "extract_dir"
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "properties": {
                                                        "architecture": {
                                                            "patternProperties": {
                                                                "^(64bit|arm64|32bit)$": {
                                                                    "required": [
                                                                        "env_add_path"
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "architecture": {
                                                    "patternProperties": {
                                                        "^(64bit|arm64|32bit)$": {
                                                            "required": [
                                                                "env_add_path"
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "properties": {
                                                        "architecture": {
                                                            "patternProperties": {
                                                                "^(64bit|arm64|32bit)$": {
                                                                    "required": [
                                                                        "bin"
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "architecture": {
                                                    "patternProperties": {
                                                        "^(64bit|arm64|32bit)$": {
                                                            "required": [
                                                                "bin"
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "autoupdate": {
                                                    "properties": {
                                                        "architecture": {
                                                            "patternProperties": {
                                                                "^(64bit|arm64|32bit)$": {
                                                                    "required": [
                                                                        "shortcuts"
                                                                    ]
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "architecture": {
                                                    "patternProperties": {
                                                        "^(64bit|arm64|32bit)$": {
                                                            "required": [
                                                                "shortcuts"
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        {
            "$comment": "Extended Specifications of abyss",
            "title": "JSON Schema of the manifest for the abyss bucket",
            "markdownDescription": "- JSON Schema of the manifest for the [abyss](https://abyss.abgox.com) bucket\n- With some special style and conventions",
            "$id": "https://github.com/abgox/abyss/blob/main/schema/scoop-manifest.en-US.json",
            "propertyNames": {
                "pattern": "^(##|version|description|homepage|license|notes|notes_cn|depends|suggest|architecture|extract_dir|extract_to|env_set|env_add_path|innosetup|psmodule|commands|bin|shortcuts|persist|pre_install|post_install|pre_uninstall|post_uninstall|checkver|autoupdate)$",
                "errorMessage": "It is not allowed."
            },
            "allOf": [
                {
                    "properties": {
                        "version": {
                            "markdownDescription": "- Version number of the software.\n- [abyss](https://abyss.abgox.com) provides special values to control manifest status: `pending`, `renamed`, `deprecated`",
                            "anyOf": [
                                {},
                                {
                                    "const": "pending",
                                    "markdownDescription": "- [abyss](https://abyss.abgox.com) special value to control manifest status: `pending`\n- Refer to: [Manifest State Control](https://abyss.abgox.com/features/manifest-state-control)"
                                },
                                {
                                    "const": "renamed",
                                    "markdownDescription": "- [abyss](https://abyss.abgox.com) special value to control manifest status: `renamed`\n- Refer to: [Manifest State Control](https://abyss.abgox.com/features/manifest-state-control)"
                                },
                                {
                                    "const": "deprecated",
                                    "markdownDescription": "- [abyss](https://abyss.abgox.com) special value to control manifest status: `deprecated`\n- Refer to: [Manifest State Control](https://abyss.abgox.com/features/manifest-state-control)"
                                }
                            ],
                            "not": {
                                "const": "0.0.0"
                            },
                            "errorMessage": "After the manifest is written, please run '.\\bin\\checkver.ps1 <app> -u' to update the manifest"
                        },
                        "description": {
                            "markdownDescription": "- A brief description of the software.\n- It should include both Chinese and English descriptions.\n ```json\n\"description\": \" xxx  xxx  | A xxx software for xxx\"\n```",
                            "examples": [
                                " | Description"
                            ],
                            "allOf": [
                                {
                                    "not": {
                                        "const": " | Description"
                                    },
                                    "errorMessage": "Please modify the description"
                                },
                                {
                                    "not": {
                                        "pattern": "^ \\|"
                                    },
                                    "errorMessage": "Please modify the Chinese description"
                                },
                                {
                                    "not": {
                                        "pattern": "\\| Description$"
                                    },
                                    "errorMessage": "Please modify the English description"
                                },
                                {
                                    "pattern": "^([^\\|]*[\\u4e00-\\u9fff][^\\|]*)\\s\\|\\s(?!\\s).*?[A-Za-z].*",
                                    "errorMessage": "It does not conform to the specified format: Chinese description | English description"
                                },
                                {
                                    "not": {
                                        "pattern": "\\|.*\\|"
                                    },
                                    "errorMessage": "It can only have one | symbol, which is used to separate Chinese and English descriptions"
                                },
                                {
                                    "not": {
                                        "pattern": "\\s{2,}\\||\\|\\s{2,}"
                                    },
                                    "errorMessage": "There should be only one space on each side of the | symbol"
                                },
                                {
                                    "not": {
                                        "pattern": "[!?] \\||[^.]\\. \\|"
                                    },
                                    "errorMessage": "Chinese description is disallowed to add symbols at the end, such as: .!?\nBut it is allowed to use ... ellipsis"
                                },
                                {
                                    "not": {
                                        "pattern": "[!?]$|[^.]\\.$"
                                    },
                                    "errorMessage": "English description is disallowed to add symbols at the end, such as: .!?\nBut it is allowed to use ... ellipsis"
                                },
                                {
                                    "not": {
                                        "pattern": "[\\u4e00-\\u9fff][A-Za-z]|[A-Za-z][\\u4e00-\\u9fff]"
                                    },
                                    "errorMessage": "Chinese and English must be separated by a space"
                                }
                            ]
                        },
                        "license": {
                            "not": {
                                "type": "string"
                            },
                            "errorMessage": "In abyss, it must be an object.",
                            "properties": {
                                "identifier": {
                                    "not": {
                                        "const": "license"
                                    },
                                    "errorMessage": "Please modify the license",
                                    "anyOf": [
                                        {
                                            "minLength": 1
                                        },
                                        {
                                            "const": "Proprietary",
                                            "markdownDescription": "- Use `Proprietary`, which is the [official field defined by Scoop](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifests#required-properties), to indicate that the software is a paid software(must pay to use)\n- In the [abyss](https://abyss.abgox.com) bucket, its meaning has changed:\n  - A professional, proprietary commercial software, whether free or not\n  - Software specified as `Proprietary` in [winget-pkgs](https://github.com/microsoft/winget-pkgs)"
                                        },
                                        {
                                            "const": "Freemium",
                                            "markdownDescription": "- Use `Freemium`This is a special value defined by [abyss](https://abyss.abgox.com): free to use, must pay to unlock advanced features"
                                        }
                                    ]
                                },
                                "url": {
                                    "not": {
                                        "pattern": "^https://github\\.com/[^/]+/[^/]+"
                                    },
                                    "errorMessage": "It is a Github address, should remove it"
                                }
                            }
                        },
                        "depends": {
                            "pattern": "^abyss/",
                            "errorMessage": "Only abyss bucket applications are allowed as dependencies, such as: abyss/xxx",
                            "items": {
                                "pattern": "^abyss/",
                                "errorMessage": "Only abyss bucket applications are allowed as dependencies, such as: abyss/xxx"
                            }
                        },
                        "suggest": {
                            "patternProperties": {
                                "^.+$": {
                                    "pattern": "^(?=abyss/|[^/\\\\]+$).+$",
                                    "errorMessage": "Only applications in abyss or main bucket are allowed as suggestions, such as: abyss/xxx or xxx",
                                    "items": {
                                        "pattern": "^(?=abyss/|[^/\\\\]+$).+$",
                                        "errorMessage": "Only applications in abyss or main bucket are allowed as suggestions, such as: abyss/xxx or xxx"
                                    }
                                }
                            }
                        },
                        "notes": {
                            "examples": [
                                []
                            ]
                        },
                        "notes_cn": {
                            "title": "Notes (Chinese)",
                            "markdownDescription": "- Chinese notes after installing the software.\n- If the current environment is Chinese, then display 'notes_cn' instead of 'notes'\n- It is a special field of [abyss](https://abyss.abgox.com)",
                            "$ref": "#/definitions/str_or_arr",
                            "examples": [
                                []
                            ]
                        },
                        "url": {
                            "not": true,
                            "errorMessage": "In abyss, it is not allowed. Please use 'architecture'."
                        },
                        "architecture": {
                            "allOf": [
                                {
                                    "properties": {
                                        "32bit": {
                                            "not": true,
                                            "errorMessage": "In abyss, it is not allowed."
                                        }
                                    }
                                },
                                {
                                    "patternProperties": {
                                        "^(64bit|arm64|32bit)$": {
                                            "properties": {
                                                "pre_install": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed to use 'pre_install' in 'architecture'.\nIf needed, it should be defined at the top level and different architectures should be distinguished through the $architecture variable."
                                                },
                                                "post_install": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed to use 'post_install' in 'architecture'.\nIf needed, it should be defined at the top level and different architectures should be distinguished through the $architecture variable."
                                                },
                                                "extract_to": {
                                                    "examples": [
                                                        "app"
                                                    ],
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed to use 'extract_to' in 'architecture'.\nIf needed, it should be defined at the top level."
                                                },
                                                "checkver": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed.\nIf needed, it should be defined at the top level."
                                                },
                                                "installer": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed."
                                                },
                                                "uninstaller": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, it is not allowed."
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "extract_to": {
                            "examples": [
                                "app"
                            ]
                        },
                        "env_add_path": {
                            "type": [
                                "string",
                                "array"
                            ],
                            "anyOf": [
                                {
                                    "allOf": [
                                        {
                                            "$ref": "#/definitions/str"
                                        },
                                        {
                                            "not": {
                                                "pattern": "\\$.+"
                                            },
                                            "errorMessage": "It cannot add paths with variables.\nPlease use 'A-Add-Path' in 'pre_install'."
                                        }
                                    ]
                                },
                                {
                                    "type": "array",
                                    "items": {
                                        "allOf": [
                                            {
                                                "$ref": "#/definitions/str"
                                            },
                                            {
                                                "not": {
                                                    "pattern": "\\$.+"
                                                },
                                                "errorMessage": "It cannot add paths with variables.\nPlease use 'A-Add-Path' in 'pre_install'."
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        "innosetup": {
                            "markdownDescription": "- If the installer is based on `InnoSetup`, set it to `true`\n- In abyss, it is recommended to use `A-Install-Inno` instead of this field",
                            "enum": [
                                true
                            ]
                        },
                        "commands": {
                            "markdownDescription": "Command Name\n- It is a special field of [abyss](https://abyss.abgox.com)\n- When `bin` field cannot define the command accurately, it should be used",
                            "$ref": "#/definitions/str_or_arr",
                            "examples": [
                                []
                            ]
                        },
                        "bin": {
                            "markdownDescription": "- A string or array of strings representing programs (executables or scripts) to be made available on the user's PATH\n- A two-dimensional array can be used to create an alias shim that uses a different name from the real executable and optionally passes arguments to it\n- The inner array must contain at most three strings: program name, alias, arguments (optional)\n- Example 1: Scoop will create a shim named `a`, so you can run a.exe by typing `a`\n```json\n  \"bin\": \"app\\\\a.exe\"\n  ```\n- Example 2: Same as Example 1, but Scoop creates two shims: `a` and `b`\n```json\n  \"bin\": [\"app\\\\a.exe\", \"app\\\\b.exe\"]\n  ```\n- Example 3: Same as Example 2, but the shims are named `ax` and `bx`\n```json\n  \"bin\": [\n    [\"app\\\\a.exe\", \"ax\"], \n    [\"app\\\\b.exe\", \"bx\"]\n  ]\n  ```\n- Example 4: Same as Example 3, but running the shims will automatically pass `--config $dir/config.json`\n```json\n  \"bin\": [\n    [\"app\\\\a.exe\", \"ax\", \"--config $dir/config.json\"], \n    [\"app\\\\b.exe\", \"bx\", \"--config $dir/config.json\"]\n  ]\n  ```",
                            "examples": [
                                "app\\xxx.exe",
                                [],
                                [
                                    [
                                        "app\\xxx.exe",
                                        "xxx"
                                    ]
                                ]
                            ],
                            "anyOf": [
                                {
                                    "allOf": [
                                        {
                                            "$ref": "#/definitions/str"
                                        },
                                        {
                                            "not": {
                                                "pattern": "\\$.+"
                                            },
                                            "errorMessage": "It cannot add paths with variables.\nPlease use 'A-Add-Path' in 'pre_install'."
                                        }
                                    ]
                                },
                                {
                                    "type": "array",
                                    "items": {
                                        "oneOf": [
                                            {
                                                "allOf": [
                                                    {
                                                        "$ref": "#/definitions/str"
                                                    },
                                                    {
                                                        "not": {
                                                            "pattern": "\\$.+"
                                                        },
                                                        "errorMessage": "It cannot add paths with variables.\nPlease use 'A-Add-Path' in 'pre_install'."
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "array",
                                                "items": [
                                                    {
                                                        "allOf": [
                                                            {
                                                                "$ref": "#/definitions/str"
                                                            },
                                                            {
                                                                "not": {
                                                                    "pattern": "\\$.+"
                                                                },
                                                                "errorMessage": "It cannot add paths with variables.\nPlease use 'A-Add-Path' in 'pre_install'."
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "allOf": [
                                                            {
                                                                "$ref": "#/definitions/str"
                                                            },
                                                            {
                                                                "not": {
                                                                    "pattern": "\\$.+"
                                                                },
                                                                "errorMessage": "It cannot contain variables."
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "$ref": "#/definitions/str"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        "shortcuts": {
                            "examples": [
                                [
                                    [
                                        "app\\xxx.exe",
                                        "xxx"
                                    ]
                                ]
                            ]
                        },
                        "persist": {
                            "markdownDescription": "- In [abyss](https://abyss.abgox.com), its definition needs to be very cautious and should refer to the possible default data directory.\n- For example, if the default data directory is `$home\\.config\\xxx`\n- When you want to define via the official [persist](https://github.com/ScoopInstaller/Scoop/wiki/Persistent-data), you should use `.config\\xxx` (if possible)\n- Especially some manifests that rely on environment variables to define the configuration data directory\n- Because its final directory structure is consistent with `A-New-LinkDirectory \"$home\\.config\\xxx\"`\n- Lay the foundation for possible seamless migration in the future\n----\nScoop will persist the specified directories and files.\n- Note: Scoop creates directory junctions by default; if you need file-level linking, create the file first in your install script.\n- Example 1: Directory junction: `$dir\\data` => `$persist_dir\\data`\n```json\n  \"persist\": \"data\"\n  ```\n- Example 2: Same as Ex.1 but multiple items\n```json\n  \"persist\": [\"data\", \"config.json\"]\n  ```\n- Example 3: Same as Ex.2 but with custom target names\n```json\n  \"persist\": [\n    [\"app\\\\data\", \"userData\"], \n    [\"app\\\\config.json\", \"config.json\"]\n  ]\n  ```"
                        },
                        "pre_install": {
                            "items": {
                                "not": {
                                    "pattern": "(?<!#.*)[]+"
                                },
                                "errorMessage": "It has invalid Chinese characters\n"
                            }
                        },
                        "installer": {
                            "not": true,
                            "errorMessage": "In abyss, it is not allowed."
                        },
                        "post_install": {
                            "items": {
                                "not": {
                                    "pattern": "(?<!#.*)[]+"
                                },
                                "errorMessage": "It has invalid Chinese characters\n"
                            }
                        },
                        "pre_uninstall": {
                            "items": {
                                "not": {
                                    "pattern": "(?<!#.*)[]+"
                                },
                                "errorMessage": "It has invalid Chinese characters\n"
                            }
                        },
                        "uninstaller": {
                            "not": true,
                            "errorMessage": "In abyss, it is not allowed."
                        },
                        "post_uninstall": {
                            "items": {
                                "not": {
                                    "pattern": "(?<!#.*)[]+"
                                },
                                "errorMessage": "It has invalid Chinese characters\n"
                            }
                        },
                        "checkver": {
                            "not": {
                                "type": "string"
                            },
                            "errorMessage": "It must be object",
                            "properties": {
                                "github": {
                                    "not": true,
                                    "errorMessage": "In abyss, it is not allowed."
                                },
                                "script": {
                                    "type": "array",
                                    "examples": [
                                        [
                                            ". $pwd\\script\\utils.ps1",
                                            "A-Get-VersionFromGithubAPI"
                                        ]
                                    ],
                                    "minItems": 1,
                                    "items": {
                                        "not": {
                                            "pattern": "(?<!#.*)[]+"
                                        },
                                        "errorMessage": "It has invalid Chinese characters\n"
                                    },
                                    "allOf": [
                                        {
                                            "items": [
                                                {
                                                    "const": ". $pwd\\script\\utils.ps1",
                                                    "markdownDescription": "Import `utils.ps1` script.\n- Features in [abyss](https://abyss.abgox.com) are implemented based on it."
                                                }
                                            ],
                                            "allOf": [
                                                {
                                                    "if": {
                                                        "contains": {
                                                            "pattern": "(?<!#.*)A-Get-InstallerInfoFromWinget"
                                                        }
                                                    },
                                                    "then": {
                                                        "items": [
                                                            {},
                                                            {
                                                                "pattern": "\\$res, \\$out = A-Get-InstallerInfoFromWinget",
                                                                "markdownDescription": "Get installer information of specified application in Winget.",
                                                                "errorMessage": "Format error, for example: \"$res, $out = A-Get-InstallerInfoFromWinget 'Publisher.PackageIdentifier' 'exe'\""
                                                            },
                                                            {
                                                                "const": "$out",
                                                                "markdownDescription": "Default installer information.\n- It provides version number, URL, etc. that can be matched.\n- You can also customize to override them.\n- For example, you can append the following content after it:\n```json\n\"\\\"x64:$($res.x64_machine.InstallerUrl -replace '\\\\.exe$', '.zip');\\\"\"\n```"
                                                            }
                                                        ],
                                                        "allOf": [
                                                            {
                                                                "items": {
                                                                    "anyOf": [
                                                                        {},
                                                                        {
                                                                            "pattern": "\\$res, \\$out = A-Get-InstallerInfoFromWinget",
                                                                            "markdownDescription": "Get installer information of specified application in Winget."
                                                                        },
                                                                        {
                                                                            "const": "\"ver:$($res.PackageVersion);\"",
                                                                            "markdownDescription": "Output version number of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"x64:$($res.x64_machine.InstallerUrl);\"",
                                                                            "markdownDescription": "Output x64 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"x64:$($res.x64_user.InstallerUrl);\"",
                                                                            "markdownDescription": "Output x64 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"x86:$($res.x86_machine.InstallerUrl);\"",
                                                                            "markdownDescription": "Output x86 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"x86:$($res.x86_user.InstallerUrl);\"",
                                                                            "markdownDescription": "Output x86 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"arm64:$($res.arm64_machine.InstallerUrl);\"",
                                                                            "markdownDescription": "Output arm64 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"arm64:$($res.arm64_user.InstallerUrl);\"",
                                                                            "markdownDescription": "Output arm64 installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"neutral:$($res.neutral_machine.InstallerUrl);\"",
                                                                            "markdownDescription": "Output neutral installer URL of specified application."
                                                                        },
                                                                        {
                                                                            "const": "\"neutral:$($res.neutral_user.InstallerUrl);\"",
                                                                            "markdownDescription": "Output neutral installer URL of specified application."
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "items": {
                                                        "anyOf": [
                                                            {},
                                                            {
                                                                "const": "A-Get-VersionFromGithubAPI",
                                                                "markdownDescription": "Get the latest release version from the GitHub repository\n- It will filter out the `v` or `V` prefix.\n  - `v1.2.3` => `1.2.3`\n  - `app-v1.2.3` => `app-1.2.3`"
                                                            },
                                                            {
                                                                "const": "A-Get-PreVersionFromGithubAPI",
                                                                "markdownDescription": "Get the latest pre-release version from the GitHub repository\n- It will filter out the `v` or `V` prefix.\n  - `v1.2.3` => `1.2.3`\n  - `app-v1.2.3` => `app-1.2.3`"
                                                            },
                                                            {
                                                                "const": "$res, $out = A-Get-InstallerInfoFromWinget 'Publisher.PackageIdentifier' 'exe'",
                                                                "markdownDescription": "Get installer information of specified application in Winget."
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                },
                                "re": {
                                    "not": true,
                                    "errorMessage": "In abyss, it is not allowed. Please use 'regex' field"
                                },
                                "jp": {
                                    "not": true,
                                    "errorMessage": "In abyss, it is not allowed. Please use 'jsonpath' field"
                                },
                                "replace": {
                                    "anyOf": [
                                        {},
                                        {
                                            "const": "pending",
                                            "markdownDescription": "Ensure that when checking for updates, the new version is `pending`"
                                        },
                                        {
                                            "const": "renamed",
                                            "markdownDescription": "Ensure that when checking for updates, the new version is `renamed`"
                                        },
                                        {
                                            "const": "deprecated",
                                            "markdownDescription": "Ensure that when checking for updates, the new version is `deprecated`"
                                        }
                                    ]
                                }
                            }
                        },
                        "autoupdate": {
                            "required": [
                                "architecture"
                            ],
                            "propertyNames": {
                                "pattern": "^(architecture|notes|notes_cn|url|hash|bin|extract_dir|extract_to|env_add_path|env_set|installer|license|persist|post_install|psmodule|shortcuts)$",
                                "errorMessage": "It is not allowed."
                            },
                            "markdownDescription": "- It will automatically update the manifest via [Github Actions](https://github.com/abgox/abyss/blob/main/.github/workflows/excavator.yml)\n - Scoop can install specific versions using `scoop install AppName@1.2.3`\n - The prerequisite is that `url` in the `autoupdate` of the manifest can only contain the following [version variables](https://github.com/ScoopInstaller/Scoop/wiki/App-Manifest-Autoupdate#version-variables)\n  - `$version`: `3.7.1.2-rc.1`\n    - `$majorVersion`: `3`\n    - `$minorVersion`: `7`\n    - `$patchVersion`: `1`\n    - `$buildVersion`: `2`\n    - `$preReleaseVersion`: `rc.1`\n  - `$dotVersion`: `3.7.1.2.rc.1`\n  - `$dashVersion`: `3-7-1-2-rc-1`\n  - `$underscoreVersion`: `3_7_1_2_rc_1`\n  - `$cleanVersion`: `3712rc1`\n  - `$matchHead`: `3.7.1`\n  - `$matchTail`: `.2-rc.1`",
                            "properties": {
                                "url": {
                                    "not": true,
                                    "errorMessage": "In abyss, it is not allowed. Please use 'architecture'."
                                },
                                "notes_cn": {
                                    "title": "Notes (Chinese)",
                                    "markdownDescription": "- Chinese notes after installing the software.\n- If the current environment is Chinese, then display 'notes_cn' instead of 'notes'\n- It is a special field of [abyss](https://abyss.abgox.com)",
                                    "$ref": "#/definitions/str_or_arr"
                                },
                                "architecture": {
                                    "properties": {
                                        "32bit": {
                                            "not": true,
                                            "errorMessage": "In abyss, it is not allowed."
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "$comment": "Required: pre_installpost_installpre_uninstallpost_uninstall",
                    "properties": {
                        "pre_install": {
                            "examples": [
                                [
                                    "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "A-Start-Install"
                                ]
                            ],
                            "type": "array",
                            "minItems": 3,
                            "items": [
                                {
                                    "const": "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    "markdownDescription": "Set `$bucket` variable.\n- If `$bucket` is null, then use `abgox-abyss-bucket-name` config."
                                },
                                {
                                    "const": ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "markdownDescription": "Import `utils.ps1` script.\n- Features in [abyss](https://abyss.abgox.com) are implemented based on it."
                                },
                                {
                                    "const": "A-Start-Install",
                                    "markdownDescription": "The start of install.\n- Install process: `pre_install` -> `installer` -> `post_install`"
                                }
                            ],
                            "allOf": [
                                {
                                    "items": {
                                        "anyOf": [
                                            {},
                                            {
                                                "const": "A-Deny-IfAppConflict 'xxx', 'yyy'",
                                                "markdownDescription": "If there is some apps conflict, the installation will be rejected.\n- It needs an array containing the package names of the apps.\n- Refer to: https://abyss.abgox.com/faq/deny-if-app-conflict"
                                            },
                                            {
                                                "pattern": "A-Deny-IfAppConflict",
                                                "markdownDescription": "If there is some apps conflict, the installation will be rejected.\n- It needs an array containing the package names of the apps.\n- Refer to: https://abyss.abgox.com/faq/deny-if-app-conflict"
                                            },
                                            {
                                                "const": "A-Deny-Manifest",
                                                "markdownDescription": "Deny install or update this app.\n- If new manifest name is given, then it means this manifest has been `renamed`, and you need to install with new name.\n- If no new manifest name is given, then it means this manifest has been `deprecated` or `pending`.\n- Refer to: https://abyss.abgox.com/faq/deny-manifest"
                                            },
                                            {
                                                "const": "A-Deny-Manifest 'newName'",
                                                "markdownDescription": "Deny install or update this app.\n- If new manifest name is given, then it means this manifest has been `renamed`, and you need to install with new name.\n- If no new manifest name is given, then it means this manifest has been `deprecated` or `pending`.\n- Refer to: https://abyss.abgox.com/faq/deny-manifest"
                                            },
                                            {
                                                "pattern": "A-Deny-Manifest",
                                                "markdownDescription": "Deny install or update this app.\n- If new manifest name is given, then it means this manifest has been `renamed`, and you need to install with new name.\n- If no new manifest name is given, then it means this manifest has been `deprecated` or `pending`.\n- Refer to: https://abyss.abgox.com/faq/deny-manifest"
                                            },
                                            {
                                                "const": "A-Add-Path \"$home\\xxx\", \"$env:ProgramFiles\\xxx\"",
                                                "markdownDescription": "Add environment variables\n- It will be automatically removed in `pre_uninstall`.\n- For example: `A-Add-Path \"$home\\xxx\", \"$env:ProgramFiles\\xxx\"`"
                                            },
                                            {
                                                "pattern": "A-Add-Path",
                                                "markdownDescription": "Add environment variables\n- It will be automatically removed in `pre_uninstall`.\n- For example: `A-Add-Path \"$home\\xxx\", \"$env:ProgramFiles\\xxx\"`"
                                            },
                                            {
                                                "const": "A-New-File \"$persist_dir\\xxx\" -Content 'xxx'",
                                                "markdownDescription": "Create file, and optionally set its content.\n- If content is an array, then it will write multiple lines.\n- For example: `A-New-File \"$persist_dir\\InputTip.ini\" -Content ''`"
                                            },
                                            {
                                                "pattern": "A-New-File",
                                                "markdownDescription": "Create file, and optionally set its content.\n- If content is an array, then it will write multiple lines.\n- For example: `A-New-File \"$persist_dir\\InputTip.ini\" -Content ''`"
                                            },
                                            {
                                                "const": "A-Copy-Item \"$bucketsdir\\$bucket\\extra\\$app\\xxx\" \"$persist_dir\\xxx\"",
                                                "markdownDescription": "Copy file or directory.\n- For example: `A-Copy-Item \"$bucketsdir\\$bucket\\extra\\$app\\InputTip.ini\" \"$persist_dir\\InputTip.ini\"`"
                                            },
                                            {
                                                "pattern": "A-Copy-Item",
                                                "markdownDescription": "Copy file or directory.\n- For example: `A-Copy-Item \"$bucketsdir\\$bucket\\extra\\$app\\InputTip.ini\" \"$persist_dir\\InputTip.ini\"`"
                                            },
                                            {
                                                "const": "A-Expand-SetupExe",
                                                "markdownDescription": "Expand setup.exe installer(#/dl.7z)\n- It will extract all files to `$dir\\app` directory.\n- Prefer `A-Install-*`.\n- Unless it is more suitable for `A-Expand-SetupExe`."
                                            },
                                            {
                                                "const": "A-Install-Inno",
                                                "markdownDescription": "Use `innosetup` installer."
                                            },
                                            {
                                                "const": "A-Install-Msi",
                                                "markdownDescription": "Use `msi` installer."
                                            },
                                            {
                                                "const": "A-Install-App -Uninstaller 'app\\uninstall.exe'",
                                                "markdownDescription": "Use the installer\n  - `-Uninstaller`: The file path of the Uninstaller\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the installer\n    - Default: `'/S', \"/D=$dir\\app\"`\n  - `-SleepSec`: The seconds to wait after the installer\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Install-App -Uninstaller 'app\\Uninstall xxx.exe'",
                                                "markdownDescription": "Use the installer\n  - `-Uninstaller`: The file path of the Uninstaller\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the installer\n    - Default: `'/S', \"/D=$dir\\app\"`\n  - `-SleepSec`: The seconds to wait after the installer\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Install-App -Uninstaller 'app\\xxx.exe'",
                                                "markdownDescription": "Use the installer\n  - `-Uninstaller`: The file path of the Uninstaller\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the installer\n    - Default: `'/S', \"/D=$dir\\app\"`\n  - `-SleepSec`: The seconds to wait after the installer\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Install-App -Uninstaller 'app\\xxx.exe' -ArgumentList '/CurrentUser','/VerySilent','/S',\"/D=$dir\\app\"",
                                                "markdownDescription": "Use the installer\n  - `-Uninstaller`: The file path of the Uninstaller\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the installer\n    - Default: `'/S', \"/D=$dir\\app\"`\n  - `-SleepSec`: The seconds to wait after the installer\n    - Default: `3`"
                                            },
                                            {
                                                "pattern": "A-Install-App",
                                                "markdownDescription": "Use the installer\n  - `-Uninstaller`: The file path of the Uninstaller\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the installer\n    - Default: `'/S', \"/D=$dir\\app\"`\n  - `-SleepSec`: The seconds to wait after the installer\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Require-Admin",
                                                "markdownDescription": "Require admin permission to run\n- Refer to: https://abyss.abgox.com/faq/require-admin"
                                            },
                                            {
                                                "const": "A-Ensure-Directory",
                                                "markdownDescription": "Ensure the specified directory path exists\n- If no parameter is given, ensure `$persist_dir` path exists\n- Example: `A-Ensure-Directory 'xxx'`"
                                            },
                                            {
                                                "const": "A-Ensure-Directory 'xxx'",
                                                "markdownDescription": "Ensure the specified directory path exists\n- If no parameter is given, ensure `$persist_dir` path exists\n- Example: `A-Ensure-Directory 'xxx'`"
                                            },
                                            {
                                                "pattern": "A-Ensure-Directory",
                                                "markdownDescription": "Ensure the specified directory path exists\n- If no parameter is given, ensure `$persist_dir` path exists\n- Example: `A-Ensure-Directory 'xxx'`"
                                            },
                                            {
                                                "const": "A-New-LinkFile \"$home\\xxx\", \"$env:AppData\\xxx\"",
                                                "markdownDescription": "Use `SymbolicLink` to link data files, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkFile \"$home\\xxx\", \"$env:AppData\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-New-LinkFile \"$home\\xxx\"",
                                                "markdownDescription": "Use `SymbolicLink` to link data files, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkFile \"$home\\xxx\", \"$env:AppData\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-New-LinkFile \"$env:AppData\\xxx\"",
                                                "markdownDescription": "Use `SymbolicLink` to link data files, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkFile \"$home\\xxx\", \"$env:AppData\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "pattern": "A-New-LinkFile",
                                                "markdownDescription": "Use `SymbolicLink` to link data files, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkFile \"$home\\xxx\", \"$env:AppData\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-New-LinkDirectory \"$env:AppData\\xxx\", \"$home\\xxx\"",
                                                "markdownDescription": "Use `Junction` to link data directories, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkDirectory \"$env:AppData\\xxx\", \"$home\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-New-LinkDirectory \"$env:AppData\\xxx\"",
                                                "markdownDescription": "Use `Junction` to link data directories, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkDirectory \"$env:AppData\\xxx\", \"$home\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-New-LinkDirectory \"$home\\xxx\"",
                                                "markdownDescription": "Use `Junction` to link data directories, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkDirectory \"$env:AppData\\xxx\", \"$home\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "pattern": "A-New-LinkDirectory",
                                                "markdownDescription": "Use `Junction` to link data directories, it will use the [Unified Specification](https://abyss.abgox.com/features/data-persistence#link-directory-structure) to generate the target directory.\n- It only allows standard directory, such as `$home`, `$env:AppData`, `$env:LocalAppData`, `$env:xxx`\n- e.g. `A-New-LinkDirectory \"$env:AppData\\xxx\", \"$home\\xxx\"`\n- If the app stores data in the app directory, use the `persist` field"
                                            },
                                            {
                                                "const": "A-Add-Font",
                                                "markdownDescription": "Install font\n- It will be automatically removed in `pre_uninstall`."
                                            },
                                            {
                                                "const": "A-Add-MsixPackage 'PackageFamilyName'",
                                                "markdownDescription": "Install AppX/Msix package\n- e.g. `A-Add-MsixPackage 'Microsoft.PowerShell_8wekyb3d8bbwe'`"
                                            },
                                            {
                                                "pattern": "A-Add-MsixPackage",
                                                "markdownDescription": "Install AppX/Msix package\n- e.g. `A-Add-MsixPackage 'Microsoft.PowerShell_8wekyb3d8bbwe'`"
                                            },
                                            {
                                                "const": "A-Add-PowerToysRunPlugin 'xxx'",
                                                "markdownDescription": "Add PowerToys Run plugin\n- It will be automatically removed in `pre_uninstall`.\n- e.g. `A-Add-PowerToysRunPlugin 'Scoop'`"
                                            },
                                            {
                                                "pattern": "A-Add-PowerToysRunPlugin",
                                                "markdownDescription": "Add PowerToys Run plugin\n- It will be automatically removed in `pre_uninstall`.\n- e.g. `A-Add-PowerToysRunPlugin 'Scoop'`"
                                            },
                                            {
                                                "const": "A-Hold-App",
                                                "markdownDescription": "After installation, automatically hold the application, preventing Scoop from updating it\n- It is typically used in conjunction with `A-Deny-Update` or `A-Uninstall-Manually` in `pre_uninstall`"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "if": {
                                        "contains": {
                                            "pattern": "(?<!#.*)A-Deny-Manifest"
                                        }
                                    },
                                    "then": {
                                        "items": [
                                            {},
                                            {},
                                            {},
                                            {
                                                "pattern": "A-Deny-Manifest",
                                                "errorMessage": "There is 'A-Deny-Manifest' in the array, so here can only be it."
                                            }
                                        ],
                                        "if": {
                                            "contains": {
                                                "pattern": "(?<!#.*)A-Deny-IfAppConflict"
                                            }
                                        },
                                        "then": {
                                            "items": [
                                                {},
                                                {},
                                                {},
                                                {},
                                                {
                                                    "pattern": "A-Deny-IfAppConflict",
                                                    "errorMessage": "There is 'A-Deny-IfAppConflict' in the array, so here can only be it."
                                                }
                                            ],
                                            "if": {
                                                "contains": {
                                                    "const": "A-Require-Admin"
                                                }
                                            },
                                            "then": {
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "const": "A-Require-Admin",
                                                        "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it."
                                                    }
                                                ]
                                            }
                                        },
                                        "else": {
                                            "if": {
                                                "contains": {
                                                    "const": "A-Require-Admin"
                                                }
                                            },
                                            "then": {
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "const": "A-Require-Admin",
                                                        "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it."
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "else": {
                                        "if": {
                                            "contains": {
                                                "pattern": "(?<!#.*)A-Deny-IfAppConflict"
                                            }
                                        },
                                        "then": {
                                            "items": [
                                                {},
                                                {},
                                                {},
                                                {
                                                    "pattern": "A-Deny-IfAppConflict",
                                                    "errorMessage": "There is 'A-Deny-IfAppConflict' in the array, so here can only be it or 'A-Deny-Manifest'."
                                                }
                                            ],
                                            "if": {
                                                "contains": {
                                                    "const": "A-Require-Admin"
                                                }
                                            },
                                            "then": {
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "const": "A-Require-Admin",
                                                        "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it."
                                                    }
                                                ]
                                            }
                                        },
                                        "else": {
                                            "if": {
                                                "contains": {
                                                    "const": "A-Require-Admin"
                                                }
                                            },
                                            "then": {
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "const": "A-Require-Admin",
                                                        "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it, 'A-Deny-Manifest' or 'A-Deny-IfAppConflict'."
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "post_install": {
                            "markdownDescription": "- For [abyss](https://abyss.abgox.com), it should be a specified fixed array usually.\n- If it is necessary to add installation logic in `post_install`, it must be ensured that the last item is `A-Complete-Install`\n---\n- Commands executed after the application is installed\n- Execution order: `pre_install` -> `installer` -> `post_install`\n- Note: At this point, Scoop has already completed persist, so if you need to create files for persist, do it before this (in `pre_install`)\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (current directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
                            "type": "array",
                            "minItems": 3,
                            "examples": [
                                [
                                    "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "A-Complete-Install"
                                ]
                            ],
                            "items": [
                                {
                                    "const": "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    "markdownDescription": "Set `$bucket` variable.\n- If `$bucket` is null, then use `abgox-abyss-bucket-name` config."
                                },
                                {
                                    "const": ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "markdownDescription": "Import `utils.ps1` script.\n- Features in [abyss](https://abyss.abgox.com) are implemented based on it."
                                }
                            ],
                            "allOf": [
                                {
                                    "contains": {
                                        "const": "A-Complete-Install"
                                    },
                                    "errorMessage": "It must contain 'A-Complete-Install', and must be the last item in the array."
                                },
                                {
                                    "$comment": "The implementation of 'if' here can cleverly restrict the last element of the array.",
                                    "if": {
                                        "oneOf": [
                                            {
                                                "items": [
                                                    {},
                                                    {},
                                                    {
                                                        "const": "A-Complete-Install",
                                                        "markdownDescription": "The end of install.\n- Any custom installation logic should be placed before it.\n- Installation process: `pre_install` -> `installer` -> `post_install`"
                                                    }
                                                ]
                                            },
                                            {
                                                "minItems": 4
                                            }
                                        ]
                                    },
                                    "else": {
                                        "not": true,
                                        "errorMessage": "Either it is the fixed array content or it is at least 4 elements long, and the last item must be A-Complete-Uninstall"
                                    }
                                }
                            ]
                        },
                        "pre_uninstall": {
                            "examples": [
                                [
                                    "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "A-Start-Uninstall",
                                    "A-Stop-Process"
                                ]
                            ],
                            "type": "array",
                            "minItems": 3,
                            "items": [
                                {
                                    "const": "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    "markdownDescription": "Set `$bucket` variable.\n- If `$bucket` is null, then use `abgox-abyss-bucket-name` config."
                                },
                                {
                                    "const": ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "markdownDescription": "Import `utils.ps1` script.\n- Features in [abyss](https://abyss.abgox.com) are implemented based on it."
                                },
                                {
                                    "const": "A-Start-Uninstall",
                                    "markdownDescription": "The start of uninstall.\n- Uninstallation process: `pre_uninstall` -> `uninstaller` -> `post_uninstall`"
                                }
                            ],
                            "allOf": [
                                {
                                    "items": {
                                        "anyOf": [
                                            {},
                                            {
                                                "const": "A-Stop-Process",
                                                "markdownDescription": "Try to stop processes to ensure successful uninstallation.\n- By default, it will stop processes in the `$dir` directory.\n- Parameters:\n  - `-ExtraPaths`: Additional directories to search.\n  - `-ExtraProcessNames`: Process names to search.\n- Examples:\n  - `A-Stop-Process 'aaa','bbb' 'xxx','yyy'`\n  - `A-Stop-Process -ExtraPaths 'aaa','bbb' -ExtraProcessNames 'xxx','yyy'`"
                                            },
                                            {
                                                "pattern": "A-Stop-Process",
                                                "markdownDescription": "Try to stop processes to ensure successful uninstallation.\n- By default, it will stop processes in the `$dir` directory.\n- Parameters:\n  - `-ExtraPaths`: Additional directories to search.\n  - `-ExtraProcessNames`: Process names to search.\n- Examples:\n  - `A-Stop-Process 'aaa','bbb' 'xxx','yyy'`\n  - `A-Stop-Process -ExtraPaths 'aaa','bbb' -ExtraProcessNames 'xxx','yyy'`"
                                            },
                                            {
                                                "const": "A-Stop-Service 'xxx' -RequireAdmin | A-Remove-Service",
                                                "markdownDescription": "Try to stop and remove specified application services to ensure successful uninstallation."
                                            },
                                            {
                                                "pattern": "A-Stop-Service .* -RequireAdmin | A-Remove-Service",
                                                "markdownDescription": "Try to stop and remove specified application services to ensure successful uninstallation."
                                            },
                                            {
                                                "const": "A-Stop-Service 'xxx' -RequireAdmin",
                                                "markdownDescription": "Try to stop specified application services to ensure successful uninstallation."
                                            },
                                            {
                                                "pattern": "A-Stop-Service .* -RequireAdmin",
                                                "markdownDescription": "Try to stop specified application services to ensure successful uninstallation."
                                            },
                                            {
                                                "const": "A-Remove-Link",
                                                "markdownDescription": "Remove SymbolicLink or Junction created by `A-New-LinkFile` and `A-New-LinkDirectory`."
                                            },
                                            {
                                                "const": "A-Remove-MsixPackage",
                                                "markdownDescription": "Remove AppX/Msix packages."
                                            },
                                            {
                                                "const": "A-Remove-TempData \"$env:LocalAppData\\xxx\"",
                                                "markdownDescription": "Remove specified temporary data files.\n- Common in `$env:LocalAppData` directory, they do not involve application configuration data and will be automatically generated.\n- For example: `A-Remove-TempData \"$env:LocalAppData\\xxx\", \"$env:LocalAppData\\yyy\"`"
                                            },
                                            {
                                                "pattern": "A-Remove-TempData",
                                                "markdownDescription": "Remove specified temporary data files.\n- Common in `$env:LocalAppData` directory, they do not involve application configuration data and will be automatically generated.\n- For example: `A-Remove-TempData \"$env:LocalAppData\\xxx\", \"$env:LocalAppData\\yyy\"`"
                                            },
                                            {
                                                "const": "A-Require-Admin",
                                                "markdownDescription": "Require running with administrator permission.\n- Refer to: https://abyss.abgox.com/faq/require-admin"
                                            },
                                            {
                                                "const": "A-Deny-Update",
                                                "markdownDescription": "Deny updating via Scoop.\n- It is usually used with `A-Hold-App` in `pre_install`.\n- Refer to: https://abyss.abgox.com/faq/deny-manifest"
                                            },
                                            {
                                                "const": "A-Uninstall-Msi",
                                                "markdownDescription": "Uninstall the application (`msi`)"
                                            },
                                            {
                                                "pattern": "A-Uninstall-Msi",
                                                "markdownDescription": "Uninstall the application (`msi`)"
                                            },
                                            {
                                                "const": "A-Uninstall-Inno",
                                                "markdownDescription": "Uninstall the application (`InnoSetup`)"
                                            },
                                            {
                                                "pattern": "A-Uninstall-Inno",
                                                "markdownDescription": "Uninstall the application (`InnoSetup`)"
                                            },
                                            {
                                                "const": "A-Uninstall-Manually 'app'",
                                                "markdownDescription": "Require user to manually uninstall the application.\n- It requires one or more directories as parameters.\n- If a relative directory is passed, such as `'app'`, it will be concatenated as `$dir\\app`.\n- Only when there are no files in these directories, will Scoop's uninstallation process be completed normally.\n- Refer to: https://abyss.abgox.com/faq/uninstall-manually"
                                            },
                                            {
                                                "pattern": "A-Uninstall-Manually",
                                                "markdownDescription": "Require user to manually uninstall the application.\n- It requires one or more directories as parameters.\n- If a relative directory is passed, such as `'app'`, it will be concatenated as `$dir\\app`.\n- Only when there are no files in these directories, will Scoop's uninstallation process be completed normally.\n- Refer to: https://abyss.abgox.com/faq/uninstall-manually"
                                            },
                                            {
                                                "const": "A-Uninstall-App -Uninstaller 'app\\uninstall.exe'",
                                                "markdownDescription": "Use the Uninstaller\n  - `-Uninstaller`: The file path of the Uninstaller\n    - Default: The uninstaller specified by `A-Install-App`\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the uninstaller\n    - Default: `'/S'`\n  - `-SleepSec`: The seconds to wait after the uninstaller\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Uninstall-App",
                                                "markdownDescription": "Use the Uninstaller\n  - `-Uninstaller`: The file path of the Uninstaller\n    - Default: The uninstaller specified by `A-Install-App`\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the uninstaller\n    - Default: `'/S'`\n  - `-SleepSec`: The seconds to wait after the uninstaller\n    - Default: `3`"
                                            },
                                            {
                                                "const": "A-Uninstall-App -Uninstaller 'app\\uninstall.exe' -ArgumentList '/VerySilent', '/Force'",
                                                "markdownDescription": "Use the Uninstaller\n  - `-Uninstaller`: The file path of the Uninstaller\n    - Default: The uninstaller specified by `A-Install-App`\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the uninstaller\n    - Default: `'/S'`\n  - `-SleepSec`: The seconds to wait after the uninstaller\n    - Default: `3`"
                                            },
                                            {
                                                "pattern": "A-Uninstall-App",
                                                "markdownDescription": "Use the Uninstaller\n  - `-Uninstaller`: The file path of the Uninstaller\n    - Default: The uninstaller specified by `A-Install-App`\n    - If it is a relative path, it will join path with `$dir`\n  - `-ArgumentList`: Command-line parameters of the uninstaller\n    - Default: `'/S'`\n  - `-SleepSec`: The seconds to wait after the uninstaller\n    - Default: `3`"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "if": {
                                        "contains": {
                                            "const": "A-Deny-Update"
                                        }
                                    },
                                    "then": {
                                        "items": [
                                            {},
                                            {},
                                            {},
                                            {
                                                "const": "A-Deny-Update",
                                                "errorMessage": "There is 'A-Deny-Update' in the array, so here can only be it."
                                            }
                                        ],
                                        "if": {
                                            "contains": {
                                                "const": "A-Require-Admin"
                                            }
                                        },
                                        "then": {
                                            "items": [
                                                {},
                                                {},
                                                {},
                                                {},
                                                {
                                                    "const": "A-Require-Admin",
                                                    "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it."
                                                }
                                            ]
                                        }
                                    },
                                    "else": {
                                        "if": {
                                            "contains": {
                                                "const": "A-Require-Admin"
                                            }
                                        },
                                        "then": {
                                            "items": [
                                                {},
                                                {},
                                                {},
                                                {
                                                    "const": "A-Require-Admin",
                                                    "errorMessage": "There is 'A-Require-Admin' in the array, so here can only be it or 'A-Deny-Update'."
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        "post_uninstall": {
                            "markdownDescription": "- For [abyss](https://abyss.abgox.com), it should be a specified fixed array usually.\n- If it is necessary to add installation logic in `post_uninstall`, it must be ensured that the last item is `A-Complete-Uninstall`\n---\n- Execute commands before uninstalling the application\n- Execution order: `pre_uninstall` -> `uninstaller` -> `post_uninstall`\n\n|Variables|Description|\n|:-:|-|\n|`$app`|Application name (manifest name)|\n|`$architecture`|CPU architecture of the installed application, e.g. 64bit/32bit/arm64|\n|`$cmd`|Current running subcommand, e.g. uninstall/update/install|\n|`$fname`|Downloaded file name (may be multiple files, treat as array unless you are sure url is not an array)|\n|`$scoopConfig`|Scoop configuration (PowerShell object), e.g. {SCOOP_BRANCH, SCOOP_REPO}|\n|`$global`|If value is $true, then it's a global installation|\n|`$manifest`|Deserialized manifest (PowerShell object), e.g. @{version=1.2.3; description=xxx;...}|\n|`$version`|Version being installed, e.g. 1.2.3|\n|`$dir`|Application installation directory (actual version number directory)|\n|`$persist_dir`|Data persistence directory|\n|`$bucketsdir`|Scoop buckets directory, e.g. D:\\scoop\\buckets|\n|`$bucket`|Name of the bucket to which the currently installed application belongs|\n|`$cachedir`|Scoop cache directory|\n|`$configFile`|Path to Scoop configuration|\n|`$globaldir`|Global installation directory|\n|`$original_dir`|Application installation directory (actual version number directory)|\n|`$scoopdir`|Scoop installation directory",
                            "type": "array",
                            "minItems": 3,
                            "examples": [
                                [
                                    "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                    ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                    "A-Complete-Uninstall"
                                ]
                            ],
                            "if": {
                                "oneOf": [
                                    {
                                        "items": [
                                            {
                                                "const": "if (!$bucket) { $bucket = (scoop config).'abgox-abyss-bucket-name' }",
                                                "markdownDescription": "Set `$bucket` variable.\n- If `$bucket` is null, then use `abgox-abyss-bucket-name` config."
                                            },
                                            {
                                                "const": ". $bucketsdir\\$bucket\\script\\utils.ps1",
                                                "markdownDescription": "Import `utils.ps1` script.\n- Features in [abyss](https://abyss.abgox.com) are implemented based on it."
                                            },
                                            {
                                                "const": "A-Complete-Uninstall",
                                                "markdownDescription": "The end of the uninstall. Any custom uninstall logic should be placed before it.\n- Uninstall process: `pre_uninstall` -> `uninstaller` -> `post_uninstall`"
                                            }
                                        ]
                                    },
                                    {
                                        "minItems": 4
                                    }
                                ]
                            },
                            "else": {
                                "not": true,
                                "errorMessage": "Either it is the fixed array content or it is at least 4 elements long, and the last item must be A-Complete-Uninstall"
                            }
                        }
                    },
                    "if": {
                        "required": [
                            "pre_install",
                            "post_install",
                            "pre_uninstall",
                            "post_uninstall"
                        ]
                    },
                    "then": {
                        "allOf": [
                            {
                                "$comment": "If A-Install-* or A-Expand-SetupExe is used in pre_install, then env_add_path and bin may need to start with app\\\\ or $env: or ${env:",
                                "if": {
                                    "properties": {
                                        "pre_install": {
                                            "type": "array",
                                            "contains": {
                                                "type": "string",
                                                "pattern": "(?<!#.*)(A-Install-\\w+|A-Expand-SetupExe)"
                                            }
                                        }
                                    }
                                },
                                "then": {
                                    "properties": {
                                        "bin": {
                                            "type": [
                                                "string",
                                                "array"
                                            ],
                                            "examples": [
                                                "app\\xxx.exe"
                                            ],
                                            "anyOf": [
                                                {
                                                    "$ref": "#/definitions/str",
                                                    "pattern": "^app\\\\",
                                                    "errorMessage": "Please check the path. Since 'A-Install-*' or 'A-Expand-SetupExe' is used, it may need to start with app\\\\"
                                                },
                                                {
                                                    "type": "array",
                                                    "items": {
                                                        "type": [
                                                            "string",
                                                            "array"
                                                        ],
                                                        "anyOf": [
                                                            {
                                                                "$ref": "#/definitions/str",
                                                                "pattern": "^app\\\\",
                                                                "errorMessage": "Please check the path. Since 'A-Install-*' or 'A-Expand-SetupExe' is used, it may need to start with app\\\\"
                                                            },
                                                            {
                                                                "type": "array",
                                                                "items": [
                                                                    {
                                                                        "pattern": "^app\\\\",
                                                                        "errorMessage": "Please check the path. Since 'A-Install-*' or 'A-Expand-SetupExe' is used, it may need to start with app\\\\"
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        },
                                        "shortcuts": {
                                            "type": "array",
                                            "examples": [
                                                [
                                                    [
                                                        "app\\xxx.exe",
                                                        "xxx"
                                                    ]
                                                ]
                                            ],
                                            "items": {
                                                "type": "array",
                                                "items": [
                                                    {
                                                        "if": {
                                                            "type": "string",
                                                            "not": {
                                                                "anyOf": [
                                                                    {
                                                                        "pattern": "^app\\\\"
                                                                    },
                                                                    {
                                                                        "pattern": "^\\$\\{?env:"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "then": {
                                                            "not": true,
                                                            "errorMessage": "Please check the path. Since 'A-Install-*' or 'A-Expand-SetupExe' is used, it may need to start with app\\\\ or $env: or ${env:"
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "$comment": "Check whether the corresponding functions in pre_uninstall exist according to the functions used in pre_install, such as A-Install-App/A-Uninstall-App",
                                "allOf": [
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Require-Admin"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "if": {
                                                        "contains": {
                                                            "pattern": "(?<!#.*)A-Uninstall-Manually"
                                                        }
                                                    },
                                                    "else": {
                                                        "contains": {
                                                            "pattern": "(?<!#.*)A-Require-Admin"
                                                        },
                                                        "errorMessage": "'A-Require-Admin' is used in 'pre_install', while 'A-Require-Admin' or 'A-Uninstall-Manually' is missing in 'pre_uninstall'"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-New-LinkFile|A-New-LinkDirectory)"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "allOf": [
                                                        {
                                                            "contains": {
                                                                "pattern": "A-Remove-Link"
                                                            },
                                                            "errorMessage": "'A-New-LinkFile' or 'A-New-LinkDirectory' is used in 'pre_install', while 'A-Remove-Link' is missing in 'pre_uninstall'"
                                                        },
                                                        {
                                                            "contains": {
                                                                "pattern": "^A-Remove-Link$"
                                                            },
                                                            "errorMessage": "'A-Remove-Link' must be on a separate line and must not contain any additional content"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-Inno"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-Uninstall-Inno|A-Uninstall-Manually)"
                                                    },
                                                    "errorMessage": "'A-Install-Inno' is used in 'pre_install', while 'A-Uninstall-Inno' or 'A-Uninstall-Manually' is missing in 'pre_uninstall'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-Msi"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-Uninstall-Msi|A-Uninstall-Manually)"
                                                    },
                                                    "errorMessage": "'A-Install-Msi' is used in 'pre_install', while 'A-Uninstall-Msi' or 'A-Uninstall-Manually' is missing in 'pre_uninstall'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-App"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-Uninstall-App|A-Uninstall-Manually|Remove-AppPackage)"
                                                    },
                                                    "errorMessage": "'A-Install-App' is used in 'pre_install', while 'A-Uninstall-App', 'A-Uninstall-Manually', or 'Remove-AppPackage' is missing in 'pre_uninstall'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Add-MsixPackage"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "allOf": [
                                                        {
                                                            "contains": {
                                                                "pattern": "A-Remove-MsixPackage"
                                                            },
                                                            "errorMessage": "'A-Add-MsixPackage' is used in 'pre_install', while 'A-Remove-MsixPackage' is missing in 'pre_uninstall'"
                                                        },
                                                        {
                                                            "contains": {
                                                                "pattern": "^A-Remove-MsixPackage$"
                                                            },
                                                            "errorMessage": "'A-Remove-MsixPackage' must be on a separate line and must not contain any additional content"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Add-Font"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "items": {
                                                        "not": {
                                                            "pattern": "(?<!#.*)A-Stop-Process"
                                                        },
                                                        "errorMessage": "The font manifest does not require 'A-Stop-Process'"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "$comment": "Check whether the corresponding functions in pre_install exist according to the functions used in pre_uninstall, such as A-Install-App/A-Uninstall-App",
                                "allOf": [
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "^A-Remove-Link$"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-New-LinkFile|A-New-LinkDirectory)"
                                                    },
                                                    "errorMessage": "'A-Remove-Link' is used in 'pre_uninstall', while 'A-New-LinkFile' or 'A-New-LinkDirectory' is missing in 'pre_install'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Uninstall-Inno"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-Inno"
                                                    },
                                                    "errorMessage": "'A-Uninstall-Inno' is used in 'pre_uninstall', while 'A-Install-Inno' is missing in 'pre_install'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Uninstall-Msi"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-Msi"
                                                    },
                                                    "errorMessage": "'A-Uninstall-Msi' is used in 'pre_uninstall', while 'A-Install-Msi' is missing in 'pre_install'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Uninstall-App"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Install-App"
                                                    },
                                                    "errorMessage": "'A-Uninstall-App' is used in 'pre_uninstall', while 'A-Install-App' is missing in 'pre_install'"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "if": {
                                            "properties": {
                                                "pre_uninstall": {
                                                    "contains": {
                                                        "pattern": "^A-Remove-MsixPackage$"
                                                    }
                                                }
                                            }
                                        },
                                        "then": {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)A-Add-MsixPackage"
                                                    },
                                                    "errorMessage": "'A-Remove-MsixPackage' is used in 'pre_uninstall', while 'A-Add-MsixPackage' is missing in 'pre_install'"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        ]
                    },
                    "else": {
                        "not": true,
                        "errorMessage": "In abyss, 'pre_install', 'post_install', 'pre_uninstall', and 'post_uninstall' must be used."
                    }
                },
                {
                    "allOf": [
                        {
                            "if": {
                                "properties": {
                                    "pre_install": {
                                        "contains": {
                                            "const": "A-Install-Msi"
                                        }
                                    }
                                }
                            },
                            "then": {
                                "properties": {
                                    "autoupdate": {
                                        "properties": {
                                            "architecture": {
                                                "patternProperties": {
                                                    "^(64bit|arm64|32bit)$": {
                                                        "properties": {
                                                            "url": {
                                                                "pattern": "#/dl.msi_$",
                                                                "errorMessage": "'A-Install-Msi' is used in 'pre_install', so 'url' should end with #/dl.msi_"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "if": {
                                "required": [
                                    "extract_to"
                                ]
                            },
                            "then": {
                                "properties": {
                                    "autoupdate": {
                                        "properties": {
                                            "architecture": {
                                                "patternProperties": {
                                                    "^(64bit|arm64|32bit)$": {
                                                        "properties": {
                                                            "url": {
                                                                "if": {
                                                                    "pattern": "\\.exe$"
                                                                },
                                                                "then": {
                                                                    "not": true,
                                                                    "errorMessage": "'extract_to' is used, but 'url' is an exe file\nIt should be a compress file, or end with #/dl.7z"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    ]
                },
                {
                    "allOf": [
                        {
                            "$comment": "If 'notes' is set, then 'notes_cn' must be set.",
                            "allOf": [
                                {
                                    "if": {
                                        "required": [
                                            "notes"
                                        ]
                                    },
                                    "then": {
                                        "if": {
                                            "required": [
                                                "notes_cn"
                                            ]
                                        },
                                        "else": {
                                            "properties": {
                                                "notes": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, if 'notes' is set, then 'notes_cn' must be set."
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "required": [
                                            "notes_cn"
                                        ]
                                    },
                                    "then": {
                                        "if": {
                                            "required": [
                                                "notes"
                                            ]
                                        },
                                        "else": {
                                            "properties": {
                                                "notes_cn": {
                                                    "not": true,
                                                    "errorMessage": "In abyss, if 'notes_cn' is set, then 'notes' must be set."
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "$comment": "When the version is specific content, the corresponding replace must be defined in checkver.",
                            "allOf": [
                                {
                                    "properties": {
                                        "version": {
                                            "$ref": "#/definitions/str"
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^pending$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "checkver": {
                                                "required": [
                                                    "replace"
                                                ],
                                                "properties": {
                                                    "replace": {
                                                        "pattern": "^pending$",
                                                        "errorMessage": "When the version is 'pending', it must be 'pending'."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^renamed$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "checkver": {
                                                "required": [
                                                    "replace"
                                                ],
                                                "properties": {
                                                    "replace": {
                                                        "pattern": "^renamed$",
                                                        "errorMessage": "When the version is 'renamed', it must be 'renamed'."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^deprecated$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "checkver": {
                                                "required": [
                                                    "replace"
                                                ],
                                                "properties": {
                                                    "replace": {
                                                        "pattern": "^deprecated$",
                                                        "errorMessage": "When the version is 'deprecated', it must be 'deprecated'."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "$comment": "When the version is specific content, the url must be the specified content",
                            "allOf": [
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^pending|renamed|deprecated$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "architecture": {
                                                "patternProperties": {
                                                    "^(64bit|arm64|32bit)$": {
                                                        "properties": {
                                                            "url": {
                                                                "type": [
                                                                    "string",
                                                                    "array"
                                                                ],
                                                                "items": {
                                                                    "pattern": "^https://github.com/abgox/abyss/releases/download/empty/empty$",
                                                                    "errorMessage": "When the version is pending|renamed|deprecated, it must be https://github.com/abgox/abyss/releases/download/empty/empty"
                                                                },
                                                                "pattern": "^https://github.com/abgox/abyss/releases/download/empty/empty$",
                                                                "errorMessage": "When the version is pending|renamed|deprecated, it must be https://github.com/abgox/abyss/releases/download/empty/empty"
                                                            },
                                                            "hash": {
                                                                "type": [
                                                                    "string",
                                                                    "array"
                                                                ],
                                                                "items": {
                                                                    "pattern": "^36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068$",
                                                                    "errorMessage": "When the version is pending|renamed|deprecated, it must be https://github.com/abgox/abyss/releases/download/empty/empty"
                                                                },
                                                                "pattern": "^36a9e7f1c95b82ffb99743e0c5c4ce95d83c9a430aac59f84ef3cbfab6145068$",
                                                                "errorMessage": "When the version is pending|renamed|deprecated, it must be https://github.com/abgox/abyss/releases/download/empty/empty"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^pending|deprecated$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "pre_install": {
                                                "minItems": 4,
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "pattern": "^A-Deny-Manifest$",
                                                        "errorMessage": "When the version is pending|deprecated, it must use 'A-Deny-Manifest'"
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "version": {
                                                "pattern": "^renamed$"
                                            }
                                        }
                                    },
                                    "then": {
                                        "properties": {
                                            "pre_install": {
                                                "minItems": 4,
                                                "items": [
                                                    {},
                                                    {},
                                                    {},
                                                    {
                                                        "pattern": "^A-Deny-Manifest\\s+['\"](.*?)['\"]",
                                                        "errorMessage": "When the version is renamed, it must be \"A-Deny-Manifest 'xxx'\"\nHere 'xxx' is the new manifest name"
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            "$comment": "Verify A-Deny-Manifest and version",
                            "if": {
                                "properties": {
                                    "pre_install": {
                                        "contains": {
                                            "pattern": "(?<!#.*)A-Deny-Manifest"
                                        }
                                    }
                                }
                            },
                            "then": {
                                "properties": {
                                    "version": {
                                        "pattern": "^pending|renamed|deprecated$",
                                        "errorMessage": "Since 'A-Deny-Manifest' is used in 'pre_install', it must be 'pending', 'renamed', or 'deprecated'"
                                    }
                                }
                            }
                        },
                        {
                            "$comment": "Since the manifest is installed through decompression and extraction, it is necessary to use extract_to to specify the directory.",
                            "if": {
                                "not": {
                                    "required": [
                                        "extract_to"
                                    ]
                                }
                            },
                            "then": {
                                "if": {
                                    "anyOf": [
                                        {
                                            "required": [
                                                "innosetup"
                                            ]
                                        },
                                        {
                                            "required": [
                                                "psmodule"
                                            ]
                                        },
                                        {
                                            "properties": {
                                                "pre_install": {
                                                    "contains": {
                                                        "pattern": "(?<!#.*)(A-Expand-SetupExe|A-Add-PowerToysRunPlugin|A-Add-Font)"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                },
                                "else": {
                                    "properties": {
                                        "architecture": {
                                            "patternProperties": {
                                                "^(64bit|arm64|32bit)$": {
                                                    "properties": {
                                                        "url": {
                                                            "type": [
                                                                "string",
                                                                "array"
                                                            ],
                                                            "not": {
                                                                "pattern": "\\.(zip|7z|tar|gz|lzma|lzh|msi|nupkg)$",
                                                                "items": {
                                                                    "pattern": "\\.(zip|7z|tar|gz|lzma|lzh|msi|nupkg)$"
                                                                }
                                                            },
                                                            "errorMessage": "Missing property 'extract_to', and it's value is usually \"app\""
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "if": {
                                "required": [
                                    "extract_to"
                                ],
                                "properties": {
                                    "extract_to": {
                                        "type": "string",
                                        "const": "app"
                                    }
                                }
                            },
                            "then": {
                                "properties": {
                                    "bin": {
                                        "type": [
                                            "string",
                                            "array"
                                        ],
                                        "examples": [
                                            "app\\xxx.exe"
                                        ],
                                        "anyOf": [
                                            {
                                                "$ref": "#/definitions/str",
                                                "pattern": "^app\\\\",
                                                "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                            },
                                            {
                                                "type": "array",
                                                "items": {
                                                    "type": [
                                                        "string",
                                                        "array"
                                                    ],
                                                    "anyOf": [
                                                        {
                                                            "$ref": "#/definitions/str",
                                                            "pattern": "^app\\\\",
                                                            "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                                        },
                                                        {
                                                            "type": "array",
                                                            "items": [
                                                                {
                                                                    "pattern": "^app\\\\",
                                                                    "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    "shortcuts": {
                                        "type": "array",
                                        "examples": [
                                            [
                                                [
                                                    "app\\xxx.exe",
                                                    "xxx"
                                                ]
                                            ]
                                        ],
                                        "items": {
                                            "type": "array",
                                            "items": [
                                                {
                                                    "if": {
                                                        "not": {
                                                            "anyOf": [
                                                                {
                                                                    "pattern": "^app\\\\"
                                                                },
                                                                {
                                                                    "pattern": "^\\$\\{?env:"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "then": {
                                                        "not": true,
                                                        "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\ or $env: or ${env:"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "architecture": {
                                        "patternProperties": {
                                            "^(64bit|arm64|32bit)$": {
                                                "properties": {
                                                    "bin": {
                                                        "type": [
                                                            "string",
                                                            "array"
                                                        ],
                                                        "examples": [
                                                            "app\\xxx.exe"
                                                        ],
                                                        "anyOf": [
                                                            {
                                                                "$ref": "#/definitions/str",
                                                                "pattern": "^app\\\\",
                                                                "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                                            },
                                                            {
                                                                "type": "array",
                                                                "items": {
                                                                    "type": [
                                                                        "string",
                                                                        "array"
                                                                    ],
                                                                    "anyOf": [
                                                                        {
                                                                            "$ref": "#/definitions/str",
                                                                            "pattern": "^app\\\\",
                                                                            "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                                                        },
                                                                        {
                                                                            "type": "array",
                                                                            "items": [
                                                                                {
                                                                                    "pattern": "^app\\\\",
                                                                                    "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\"
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    },
                                                    "shortcuts": {
                                                        "type": "array",
                                                        "examples": [
                                                            [
                                                                [
                                                                    "app\\xxx.exe",
                                                                    "xxx"
                                                                ]
                                                            ]
                                                        ],
                                                        "items": {
                                                            "type": "array",
                                                            "items": [
                                                                {
                                                                    "if": {
                                                                        "not": {
                                                                            "anyOf": [
                                                                                {
                                                                                    "pattern": "^app\\\\"
                                                                                },
                                                                                {
                                                                                    "pattern": "^\\$\\{?env:"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "then": {
                                                                        "not": true,
                                                                        "errorMessage": "Please check the path. Since extract_to is specified as \"app\", it may need to start with app\\\\ or $env: or ${env:"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "$comment": "If the URL is powershellgallery.com, then psmodule needs to be specified.",
                            "if": {
                                "required": [
                                    "autoupdate"
                                ],
                                "properties": {
                                    "autoupdate": {
                                        "properties": {
                                            "architecture": {
                                                "properties": {
                                                    "64bit": {
                                                        "properties": {
                                                            "url": {
                                                                "type": "string",
                                                                "pattern": "\\.powershellgallery\\.com/packages/"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "then": {
                                "required": [
                                    "psmodule"
                                ]
                            }
                        }
                    ]
                },
                {
                    "if": {
                        "required": [
                            "checkver"
                        ],
                        "properties": {
                            "checkver": {
                                "required": [
                                    "script"
                                ],
                                "properties": {
                                    "script": {
                                        "contains": {
                                            "pattern": "(?<!#.*)A-Get-VersionFromGithubAPI"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "then": {
                        "properties": {
                            "checkver": {
                                "properties": {
                                    "regex": {
                                        "pattern": "\\(\\.\\+\\)",
                                        "errorMessage": "Since 'A-Get-VersionFromGithubAPI' is used, it must contain (.+)"
                                    }
                                }
                            }
                        },
                        "if": {
                            "properties": {
                                "checkver": {
                                    "required": [
                                        "url"
                                    ]
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "checkver": {
                                    "properties": {
                                        "url": {
                                            "pattern": "(^https://github\\.com/[^/]+/[^/]+$)|(^https://api.github\\.com/repos/[^/]+/[^/]+)",
                                            "errorMessage": "Since 'A-Get-VersionFromGithubAPI' is used, it must be a Github URL or REST API, like:\nhttps://github.com/abgox/json-schema-plus\nhttps://api.github.com/repos/abgox/json-schema-plus/releases?per_page=5"
                                        }
                                    }
                                }
                            }
                        },
                        "else": {
                            "properties": {
                                "autoupdate": {
                                    "properties": {
                                        "architecture": {
                                            "patternProperties": {
                                                "^(64bit|arm64|32bit)$": {
                                                    "properties": {
                                                        "url": {
                                                            "$ref": "#/definitions/str_or_arr",
                                                            "allOf": [
                                                                {
                                                                    "pattern": "^https://github\\.com/[^/]+/[^/]+",
                                                                    "errorMessage": "Since 'A-Get-VersionFromGithubAPI' is used, it must be a Github URL. Otherwise, please define 'checkver.url'."
                                                                },
                                                                {
                                                                    "contains": {
                                                                        "pattern": "^https://github\\.com/[^/]+/[^/]+"
                                                                    },
                                                                    "errorMessage": "Since 'A-Get-VersionFromGithubAPI' is used, it has at least one Github URL. Otherwise, please define 'checkver.url'."
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "$comment": "If checkver uses A-Get-InstallerInfoFromWinget through the script field",
                    "if": {
                        "required": [
                            "checkver"
                        ],
                        "properties": {
                            "checkver": {
                                "required": [
                                    "script"
                                ],
                                "properties": {
                                    "script": {
                                        "contains": {
                                            "pattern": "(?<!#.*)A-Get-InstallerInfoFromWinget"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "then": {
                        "properties": {
                            "checkver": {
                                "properties": {
                                    "regex": {
                                        "const": "(?:.*ver:(?<version>[^;]+))(?:.*x64:(?<x64>[^;]+))?(?:.*x86:(?<x86>[^;]+))?(?:.*arm64:(?<arm64>[^;]+))?",
                                        "errorMessage": "Since 'A-Get-InstallerInfoFromWinget' is used, it must be \"(?:.*ver:(?<version>[^;]+))(?:.*x64:(?<x64>[^;]+))?(?:.*x86:(?<x86>[^;]+))?(?:.*arm64:(?<arm64>[^;]+))?\""
                                    },
                                    "script": {
                                        "items": [
                                            {},
                                            {},
                                            {
                                                "const": "$out"
                                            }
                                        ]
                                    }
                                }
                            },
                            "autoupdate": {
                                "properties": {
                                    "architecture": {
                                        "patternProperties": {
                                            "^(64bit|arm64|32bit)$": {
                                                "properties": {
                                                    "url": {
                                                        "examples": [
                                                            "$matchX64",
                                                            "$matchX64#/dl.7z",
                                                            "$matchX64#/dl.exe",
                                                            "$matchX64#/dl.msi_",
                                                            "$matchArm64",
                                                            "$matchArm64#/dl.7z",
                                                            "$matchArm64#/dl.exe",
                                                            "$matchArm64#/dl.msi_",
                                                            "$matchX86",
                                                            "$matchX86#/dl.7z",
                                                            "$matchX86#/dl.exe",
                                                            "$matchX86#/dl.msi_"
                                                        ]
                                                    }
                                                },
                                                "if": {
                                                    "properties": {
                                                        "url": {
                                                            "pattern": "^https://"
                                                        }
                                                    }
                                                },
                                                "else": {
                                                    "required": [
                                                        "hash"
                                                    ],
                                                    "properties": {
                                                        "url": {
                                                            "markdownDescription": "- For the installation package URL provided by `A-Get-InstallerInfoFromWinget`\n- It usually uses variables like `$matchX64`\n- Some examples can be viewed through field completion"
                                                        },
                                                        "hash": {
                                                            "properties": {
                                                                "url": {
                                                                    "const": "temp-autoupdate.json",
                                                                    "markdownDescription": "The temporary file where the installer information is stored\n- `A-Get-InstallerInfoFromWinget` will write the information to `temp-autoupdate.json` in the project root directory\n- Therefore, it must be `temp-autoupdate.json`",
                                                                    "errorMessage": "Since 'A-Get-InstallerInfoFromWinget' is used, it must be \"temp-autoupdate.json\""
                                                                },
                                                                "jsonpath": {
                                                                    "enum": [
                                                                        "$.x64_machine.InstallerSha256",
                                                                        "$.arm64_machine.InstallerSha256",
                                                                        "$.x86_machine.InstallerSha256",
                                                                        "$.x64_user.InstallerSha256",
                                                                        "$.arm64_user.InstallerSha256",
                                                                        "$.x86_user.InstallerSha256",
                                                                        "$.neutral_machine.InstallerSha256",
                                                                        "$.neutral_user.InstallerSha256"
                                                                    ],
                                                                    "markdownDescription": "hash\n- Select the correct field based on `temp-autoupdate.json`"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "properties": {
                        "autoupdate": {
                            "properties": {
                                "architecture": {
                                    "patternProperties": {
                                        "^(64bit|arm64|32bit)$": {
                                            "properties": {
                                                "url": {
                                                    "pattern": "\\$.+",
                                                    "errorMessage": "It does not use dynamic version variables like $version. Please check carefully.",
                                                    "examples": [
                                                        "",
                                                        []
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            ]
        }
    ]
}
